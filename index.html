<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('http://yoursite.com').hostname,
    root: '/',
    scheme: 'Muse',
    version: '7.7.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false
  };
</script>

  <title>Hexo</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/02/18/Tensorflow%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BA%8C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/18/Tensorflow%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BA%8C/" class="post-title-link" itemprop="url">Tensorflowå­¦ä¹ ç¬”è®°(äºŒ)</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2021-02-18 19:23:12 / Modified: 20:48:59" itemprop="dateCreated datePublished" datetime="2021-02-18T19:23:12+08:00">2021-02-18</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="ä½¿ç”¨å…«è‚¡æ­å»ºç¥ç»ç½‘ç»œ"><a href="#ä½¿ç”¨å…«è‚¡æ­å»ºç¥ç»ç½‘ç»œ" class="headerlink" title="ä½¿ç”¨å…«è‚¡æ­å»ºç¥ç»ç½‘ç»œ"></a>ä½¿ç”¨å…«è‚¡æ­å»ºç¥ç»ç½‘ç»œ</h1><p><strong>ç”¨Tensorflow APIï¼štf.kerasæ­å»ºç½‘ç»œå…«è‚¡</strong>   </p>
<p><strong>ğŸ±å…­æ­¥æ³•</strong></p>
<ul>
<li>importç›¸å…³æ¨¡å—   </li>
<li>ç¡®å®šè®­ç»ƒé›†å’Œæµ‹è¯•é›†<br>  æŒ‡å®šè®­ç»ƒé›†çš„è¾“å…¥ç‰¹å¾å’Œæ ‡ç­¾ï¼›<br>  æŒ‡å®šæµ‹è¯•é›†çš„è¾“å…¥ç‰¹å¾å’Œæ ‡ç­¾ã€‚   </li>
<li>åœ¨<code>Sequential()</code>ä¸­æ­å»ºç½‘ç»œç»“æ„ï¼Œé€å±‚æè¿°æ¯å±‚ç½‘ç»œ<br>  ç›¸å½“äºèµ°ä¸€éå‰å‘ä¼ æ’­   </li>
<li>åœ¨<code>compile()</code>ä¸­é…ç½®è®­ç»ƒæ–¹æ³•<br>  å‘ŠçŸ¥è®­ç»ƒæ—¶é€‰æ‹©å“ªç§ä¼˜åŒ–å™¨ï¼›<br>  é€‰æ‹©å“ªç§æŸå¤±å‡½æ•°ï¼›<br>  é€‰æ‹©å“ªç§è¯„æµ‹æŒ‡æ ‡ï¼›   </li>
<li>åœ¨<code>fit()</code>ä¸­æ‰§è¡Œè®­ç»ƒè¿‡ç¨‹<br>  å‘ŠçŸ¥è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„è¾“å…¥ç‰¹å¾å’Œæ ‡ç­¾ï¼›<br>  æ¯ä¸ªbatchæ˜¯å¤šå°‘ï¼›<br>  è¿­ä»£å¤šå°‘æ¬¡è®­ç»ƒé›†ï¼›  </li>
<li>ç”¨<code>summary()</code>æ‰“å°å‡ºç½‘ç»œçš„ç»“æ„å’Œå‚æ•°ç»Ÿè®¡  </li>
</ul>
<h2 id="Sequential"><a href="#Sequential" class="headerlink" title="Sequential()"></a>Sequential()</h2><pre><code># æè¿°ä»è¾“å…¥å±‚åˆ°è¾“å‡ºå±‚ï¼Œæ¯ä¸€å±‚çš„ç½‘ç»œç»“æ„
âœ¨model = tf.keras.models.Sequential([ç½‘ç»œç»“æ„])     

# æ¯ä¸€å±‚çš„ç½‘ç»œç»“æ„ï¼Œå¯ä»¥æ˜¯ğŸ‘‡  

#æ‹‰ç›´å±‚  
#è¯¥å±‚ä¸å«è®¡ç®—ï¼Œåªæ˜¯å½¢çŠ¶è½¬æ¢
#æŠŠè¾“å…¥ç‰¹å¾æ‹‰ç›´å˜æˆä¸€ç»´æ•°ç»„
tf.keras.layers.Flatten()


#å…¨è¿æ¥å±‚  
tf.keras.layers.Dense(ç¥ç»å…ƒä¸ªæ•°,activation=&apos;æ¿€æ´»å‡½æ•°&apos;,kernel_regularizer=é‚£ç§æ­£åˆ™åŒ–)   
#activation(ä»¥å­—ç¬¦ä¸²å½¢å¼ç»™å‡º)å¯é€‰: reluã€softmaxã€sigmoidã€tanh   
#kernel_regularizer å¯é€‰: tf.keras.regularizers.l1()ã€tf.keras.regularizers.l2()   

#å·ç§¯å±‚  
tf.keras.layers.Conv2D(filters=å·ç§¯æ ¸ä¸ªæ•°,kernel_size=å·ç§¯æ ¸å°ºå¯¸,strides=å·ç§¯æ­¥é•¿,padding=&quot;valid&quot;or&quot;same&quot;)    


#LSTMå±‚(å¾ªç¯ç¥ç»ç½‘ç»œå±‚)  
tf.keras.layers.LSTM()</code></pre><h2 id="compile"><a href="#compile" class="headerlink" title="compile()"></a>compile()</h2><pre><code>âœ¨model.complie(optimizer=ä¼˜åŒ–å™¨,loss=æŸå¤±å‡½æ•°,metrics=[&quot;å‡†ç¡®ç‡&quot;])



#ä¼˜åŒ–å™¨optimizerå¯ä»¥æ˜¯å­—ç¬¦ä¸²å½¢å¼ç»™å‡ºçš„ğŸ‘‡   
&gt;&gt;&apos;sgd&apos; or tf.keras.optimizers.SGD(lr=å­¦ä¹ ç‡,momentum=åŠ¨é‡å‚æ•°) 

&gt;&gt;&apos;adagrad&apos; pr tf.keras.optimizers.Adagrad(lr=*)

&gt;&gt;&apos;adadelta&apos; or tf.keras.optimizers.Adadelta(lr=*)   



#æŸå¤±å‡½æ•°lossğŸ‘‡   
&gt;&gt;&apos;mse&apos; or tf.keras.losses.MeanSquaredError()  

&gt;&gt;&apos;sparse_categorical_crossentropy&apos; or tf.keras.losses.SparseCategoricalCrossentropy(from_logits=False)  
#ğŸ‘†è¿™ä¸ªå‡½æ•°çš„å‚æ•°æ˜¯åœ¨è¯¢é—®æ˜¯å¦åŸå§‹è¾“å‡ºï¼›
#ç¥ç»ç½‘ç»œé¢„æµ‹ç»“æœè¾“å‡ºå‰ç»è¿‡æ¦‚ç‡åˆ†å¸ƒï¼Œå°±ä¸æ˜¯åŸå§‹è¾“å‡ºï¼Œæ­¤æ—¶å°±æ˜¯False



#ç½‘ç»œè¯„æµ‹æŒ‡æ ‡MetricsğŸ‘‡:  
&gt;&gt;&apos;accuracy&apos;:y_å’Œyéƒ½æ˜¯æ•°å€¼ï¼Œå¦‚y_=[1],y=[1]  

&gt;&gt;&apos;categorical_accuracy&apos;:y_å’Œyéƒ½æ˜¯ç‹¬çƒ­ç (æ¦‚ç‡åˆ†å¸ƒ),å¦‚y_=[0,1,0],y=[0.256,0.695,0.048] 

&gt;&gt;&apos;sparse_categorical_accuracy&apos;:y_æ˜¯æ•°å€¼ï¼Œyæ˜¯ç‹¬çƒ­ç (æ¦‚ç‡åˆ†å¸ƒ),å¦‚y_=[1],y=[0.256,0.695.0.048]   </code></pre><h2 id="fit"><a href="#fit" class="headerlink" title="fit()"></a>fit()</h2><pre><code>âœ¨model.fit(è®­ç»ƒé›†çš„è¾“å…¥ç‰¹å¾,è®­ç»ƒé›†çš„æ ‡ç­¾,batch_size= , epochs= ,validation_data=(æµ‹è¯•é›†çš„è¾“å…¥ç‰¹å¾,æµ‹è¯•é›†çš„æ ‡ç­¾),validation_split=ä»è®­ç»ƒé›†åˆ’åˆ†å¤šå°‘æ¯”ä¾‹ç»™æµ‹è¯•é›†,validation_freq=å¤šå°‘æ¬¡epochæµ‹è¯•ä¸€æ¬¡)   </code></pre><ul>
<li>validation_dataä¸validation_splitä¸¤è€…é€‰å…¶ä¸€  </li>
</ul>
<h2 id="model-summay"><a href="#model-summay" class="headerlink" title="model.summay()"></a>model.summay()</h2><p>æ‰“å°å‡ºç½‘ç»œçš„ç»“æ„å’Œå‚æ•°ç»Ÿè®¡<br><img src="https://i.loli.net/2021/02/18/1nCZIvTzxstSBQM.png" alt="image.png">   </p>
<h2 id="é¸¢å°¾èŠ±ç¤ºä¾‹"><a href="#é¸¢å°¾èŠ±ç¤ºä¾‹" class="headerlink" title="é¸¢å°¾èŠ±ç¤ºä¾‹"></a>é¸¢å°¾èŠ±ç¤ºä¾‹</h2><pre><code>import tensorflow as tf
from sklearn import datasets
import numpy as np

x_train = datasets.load_iris().data
y_train = datasets.load_iris().target

np.random.seed(116)
np.random.shuffle(x_train)
np.random.seed(116)
np.random.shuffle(y_train)
tf.random.set_seed(116)

model = tf.keras.models.Sequential([
    tf.keras.layers.Dense(3, activation=&apos;softmax&apos;, kernel_regularizer=tf.keras.regularizers.l2())
])

model.compile(optimizer=tf.keras.optimizers.SGD(lr=0.1),
            loss=tf.keras.losses.SparseCategoricalCrossentropy(from_logits=False),
            metrics=[&apos;sparse_categorical_accuracy&apos;])

model.fit(x_train, y_train, batch_size=32, epochs=500, validation_split=0.2, validation_freq=20)

model.summary()</code></pre>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/01/27/%E9%B8%A2%E9%B8%9F%E9%9B%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/27/%E9%B8%A2%E9%B8%9F%E9%9B%86/" class="post-title-link" itemprop="url">é¸¢é¸Ÿé›†</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-01-27 20:52:42" itemprop="dateCreated datePublished" datetime="2021-01-27T20:52:42+08:00">2021-01-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-01-30 21:26:29" itemprop="dateModified" datetime="2021-01-30T21:26:29+08:00">2021-01-30</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="ğŸå®ç°é¸¢å°¾èŠ±åˆ†ç±»æ•´ä½“æ€è·¯"><a href="#ğŸå®ç°é¸¢å°¾èŠ±åˆ†ç±»æ•´ä½“æ€è·¯" class="headerlink" title="ğŸå®ç°é¸¢å°¾èŠ±åˆ†ç±»æ•´ä½“æ€è·¯"></a>ğŸå®ç°é¸¢å°¾èŠ±åˆ†ç±»æ•´ä½“æ€è·¯</h1><h2 id="ğŸ‹å‡†å¤‡æ•°æ®"><a href="#ğŸ‹å‡†å¤‡æ•°æ®" class="headerlink" title="ğŸ‹å‡†å¤‡æ•°æ®"></a>ğŸ‹å‡†å¤‡æ•°æ®</h2><ul>
<li>æ•°æ®é›†è¯»å…¥</li>
<li>æ•°æ®é›†ä¹±åº</li>
<li>ç”Ÿæˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†</li>
<li>é…æˆï¼ˆè¾“å…¥ç‰¹å¾ã€æ ‡ç­¾ï¼‰å¯¹ï¼Œæ¯æ¬¡è¯»å…¥batch    </li>
</ul>
<h2 id="ğŸ‹æ­å»ºç½‘ç»œ"><a href="#ğŸ‹æ­å»ºç½‘ç»œ" class="headerlink" title="ğŸ‹æ­å»ºç½‘ç»œ"></a>ğŸ‹æ­å»ºç½‘ç»œ</h2><ul>
<li>å®šä¹‰ç¥ç»ç½‘ç»œä¸­æ‰€æœ‰å¯è®­ç»ƒå‚æ•°    </li>
</ul>
<h2 id="ğŸ‹å‚æ•°ä¼˜åŒ–"><a href="#ğŸ‹å‚æ•°ä¼˜åŒ–" class="headerlink" title="ğŸ‹å‚æ•°ä¼˜åŒ–"></a>ğŸ‹å‚æ•°ä¼˜åŒ–</h2><ul>
<li>åµŒå¥—å¾ªç¯è¿­ä»£ï¼Œwithç»“æ„æ›´æ–°å‚æ•°ï¼Œæ˜¾ç¤ºå½“å‰loss   </li>
</ul>
<h2 id="ğŸ‹æµ‹è¯•æ•ˆæœ"><a href="#ğŸ‹æµ‹è¯•æ•ˆæœ" class="headerlink" title="ğŸ‹æµ‹è¯•æ•ˆæœ"></a>ğŸ‹æµ‹è¯•æ•ˆæœ</h2><ul>
<li>è®¡ç®—å½“å‰å‚æ•°å‰åä¼ æ’­åçš„å‡†ç¡®ç‡ï¼Œæ˜¾ç¤ºå½“å‰acc  </li>
</ul>
<h2 id="ğŸ‹acc-losså¯è§†åŒ–"><a href="#ğŸ‹acc-losså¯è§†åŒ–" class="headerlink" title="ğŸ‹acc/losså¯è§†åŒ–"></a>ğŸ‹acc/losså¯è§†åŒ–</h2><h1 id="ğŸå‡†å¤‡"><a href="#ğŸå‡†å¤‡" class="headerlink" title="ğŸå‡†å¤‡"></a>ğŸå‡†å¤‡</h1><h2 id="ğŸ‹æ•°æ®é›†è¯»å…¥"><a href="#ğŸ‹æ•°æ®é›†è¯»å…¥" class="headerlink" title="ğŸ‹æ•°æ®é›†è¯»å…¥"></a>ğŸ‹æ•°æ®é›†è¯»å…¥</h2><p>ä»<code>sklearn.datasets</code>ä¸­å¯ä»¥å¾—åˆ°é¸¢é¸Ÿçš„æ•°æ®åŒ…<br>ä¹Ÿå°±æ˜¯ï¼Œé¦–å…ˆè¦æœ‰<code>sklearn</code>åŒ…,é€šè¿‡<code>pip instal sklearn</code>è·å¾—</p>
<pre><code>from sklearn.datasets import load_iris
from pandas import DataFrame  #å¤„ç†æ•°æ®ï¼Œå½¢æˆè¡¨æ ¼ï¼Œæ›´ç›´è§‚
import pandas as pd

x_data = load_iris().data
y_data = load_iris().target
#è·å¾—ç‰¹å¾å’Œå¯¹åº”çš„æ ‡ç­¾

x_data = DataFrame(x_data, columns=[&apos;èŠ±è¼é•¿åº¦&apos;, &apos;èŠ±è¼å®½åº¦&apos;, &apos;èŠ±ç“£é•¿åº¦&apos;, &apos;èŠ±ç“£å®½åº¦&apos;]) # ä¸ºè¡¨æ ¼å¢åŠ è¡Œç´¢å¼•ï¼ˆå·¦ä¾§ï¼‰å’Œåˆ—æ ‡ç­¾ï¼ˆä¸Šæ–¹ï¼‰
pd.set_option(&apos;display.unicode.east_asian_width&apos;, True)  # è®¾ç½®åˆ—åå¯¹é½

x_data[&apos;ç±»åˆ«&apos;] = y_data  # æ–°åŠ ä¸€åˆ—ï¼Œåˆ—æ ‡ç­¾ä¸ºâ€˜ç±»åˆ«â€™ï¼Œæ•°æ®ä¸ºy_data

print(x_data)</code></pre><p><img src="https://i.loli.net/2021/01/27/u1WnPpVtriXq9Gj.png" alt="ç»“æœ"></p>
<h2 id="ğŸ±å…³äºDataFrame"><a href="#ğŸ±å…³äºDataFrame" class="headerlink" title="ğŸ±å…³äºDataFrame"></a>ğŸ±å…³äºDataFrame</h2><h3 id="åˆ›å»º"><a href="#åˆ›å»º" class="headerlink" title="åˆ›å»º"></a>åˆ›å»º</h3><p>åˆ›å»ºä¸€ä¸ªDataFrameï¼Œç›¸å½“äºè¿™ä¸€å †æ•°æ®å°±æ˜¯ä¸€ä¸ªè¡¨æ ¼ï¼Œåˆ›å»ºæ—¶ï¼Œä¼šé»˜è®¤ç»™æ–°å¢ä¸€åˆ—åœ¨æœ€å·¦ä¾§ï¼Œæ˜¯ç´¢å¼•ï¼Œä»0å¼€å§‹ï¼›<br>å¦‚æœæ•°æ®æ˜¯å­—å…¸å‹ï¼Œåˆ™å·²ç»ç¡®å®šå¥½äº†åˆ—åã€‚<br>è‹¥æ˜¯æ•°ç»„ï¼Œåˆ™å¯é€šè¿‡<code>columns=[]</code>æ¥å‘½åå„åˆ—ã€‚<br><img src="https://i.loli.net/2021/01/27/LOs6ztbnkuYgAPx.png" alt="ä¾‹å­"></p>
<h3 id="æ’å…¥"><a href="#æ’å…¥" class="headerlink" title="æ’å…¥"></a>æ’å…¥</h3><p>åˆ›å»ºä¹‹åï¼Œå°±æ˜¯ä¸€ä¸ªå¯æ“ä½œçš„DataFrame<br>åˆ™è‹¥è¦æ–°å¢ä¸€åˆ—(æœ€åä¸€åˆ—)ï¼Œå¯ç›´æ¥<code>x[&#39;åˆ—å&#39;]=[å†…å®¹]</code>ã€‚<br>è‹¥è¦æŒ‡å®šæ’å…¥ä¸€åˆ—<code>x.insert(æ’å…¥åæ‰€å¤„çš„åˆ—æ•°ï¼Œåˆ—åï¼Œå†…å®¹)</code><br><img src="https://i.loli.net/2021/01/27/AJx4Sdse9h2w1VU.png" alt="image.png"></p>
<h3 id="æŸ¥æ‰¾"><a href="#æŸ¥æ‰¾" class="headerlink" title="æŸ¥æ‰¾"></a>æŸ¥æ‰¾</h3><p><strong>åˆ—</strong><br>å¯ç›´æ¥<code>x[åˆ—å]</code><br>å½“ç„¶å¯ç›´æ¥é€šè¿‡æ­¤èµ‹å€¼<code>x[åˆ—å]=[å†…å®¹]</code><br><strong>è¡Œ</strong><br>ç›´æ¥<code>x.loc[&#39;è¡Œå&#39;]</code>   </p>
<p><strong>è¡Œå’Œåˆ—</strong>  </p>
<pre><code>x.iloc[:,:]   
#å¯ä»¥çœ‹åˆ°ï¼Œç¬¬ä¸€ä¸ªæ˜¯å‡ è¡Œï¼Œç¬¬äºŒä¸ªæ˜¯å‡ åˆ—ã€‚
#æ³¨æ„ï¼Œéƒ½æ˜¯ä»0è®¡æ•°ä¸”å‰é—­åå¼€ </code></pre><p><img src="https://i.loli.net/2021/01/27/InPzHicRCvDZMyS.png" alt="image.png"></p>
<h3 id="ç´¢å¼•è¡¥å……"><a href="#ç´¢å¼•è¡¥å……" class="headerlink" title="ç´¢å¼•è¡¥å……"></a>ç´¢å¼•è¡¥å……</h3><p>ç´¢å¼•é™¤äº†æœ€å¼€å§‹åœ¨åˆ›å»ºæ—¶åˆ›å»ºä»¥å¤–ï¼Œåœ¨åˆ›å»ºåä¹Ÿå¯ä»¥æ›´æ”¹ã€‚   </p>
<ol>
<li><p>å°†è‡ªå·±çš„ä¸€åˆ—è®¾ç½®ä¸ºç´¢å¼•<code>x.set_index([åˆ—å],drop=True)</code><br>dropé»˜è®¤æ˜¯Trueï¼Œæ„æ€æ˜¯ï¼Œå°†è¯¥åˆ—ä½œä¸ºç´¢å¼•åï¼Œä¸ä¿å­˜è¯¥åˆ—æ•°æ®ï¼›æ”¹ä¸ºFalseï¼Œåˆ™ä¿å­˜è¯¥åˆ—æ•°æ®ã€‚<br><img src="https://i.loli.net/2021/01/27/jksDGTqL9dFHhWa.png" alt="image.png"></p>
</li>
<li><p>ç›´æ¥åˆ›å»º<code>x.index=[1,2,3,4,5]</code></p>
</li>
<li><p>è¿˜åŸæˆé»˜è®¤å€¼<code>x.reset_index(drop=False)</code><br>dropé»˜è®¤å€¼æ˜¯Falseï¼Œæ˜¯æŒ‡å°†åŸæ¥çš„ç´¢å¼•å€¼ä¿ç•™ä¸ºæ•°æ®ï¼›è‹¥ä¸ºTrueï¼Œåˆ™åŸç´¢å¼•å€¼åˆ é™¤ã€‚<br><img src="https://i.loli.net/2021/01/27/TbaqnWCr7gHPOLl.png" alt="image.png"></p>
</li>
</ol>
<h2 id="ğŸ‹æ•°æ®é›†ä¹±åº"><a href="#ğŸ‹æ•°æ®é›†ä¹±åº" class="headerlink" title="ğŸ‹æ•°æ®é›†ä¹±åº"></a>ğŸ‹æ•°æ®é›†ä¹±åº</h2><pre><code>np.random.seed(116) #æ˜¯ç”¨ç›¸åŒçš„seedï¼Œä½¿è¾“å…¥ç‰¹å¾/æ ‡ç­¾ä¸€ä¸€å¯¹åº”
np.random.shuffle(x_data)
np.random.seed(116)
np.random.shuffle(y_data)
tf.random.set_seed(116)</code></pre><h2 id="ğŸ‹åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†"><a href="#ğŸ‹åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†" class="headerlink" title="ğŸ‹åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†"></a>ğŸ‹åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†</h2><pre><code>x_train = x_data[:-30]
y_train = y_data[:-30]
x_test = x_data[-30:]
y_test = y_data[-30:]</code></pre><h2 id="ğŸ‹é…å¯¹"><a href="#ğŸ‹é…å¯¹" class="headerlink" title="ğŸ‹é…å¯¹"></a>ğŸ‹é…å¯¹</h2><pre><code>train_db = tf.data.Dataset.from_tensor_slices((x_trainm4,y_train)).batch(32)
test_db = tf.data.Dataset.from_tensor_slices((x_test,y_test)).batch(32)</code></pre><h1 id="ğŸæ­å»ºç½‘ç»œ"><a href="#ğŸæ­å»ºç½‘ç»œ" class="headerlink" title="ğŸæ­å»ºç½‘ç»œ"></a>ğŸæ­å»ºç½‘ç»œ</h1><pre><code>w1 = tf.Variable(tf.random.truncated_normal([4,3],stddev=0.1,seed=1))
b1 = tf.Variable(tf.random.truncated_normal([4,3],stddev=0.1,seed=1))

for epoch in range(epoch):
    for step,(x_train,y_train) in enumerate(train_db):
        with tf.GradientTape() as tape:
            y = tf.matmul(x_train, w1) + b1  # ç¥ç»ç½‘ç»œä¹˜åŠ è¿ç®—
            y = tf.nn.softmax(y)  # ä½¿è¾“å‡ºyç¬¦åˆæ¦‚ç‡åˆ†å¸ƒï¼ˆæ­¤æ“ä½œåä¸ç‹¬çƒ­ç åŒé‡çº§ï¼Œå¯ç›¸å‡æ±‚lossï¼‰
            y_ = tf.one_hot(y_train, depth=3)  # å°†æ ‡ç­¾å€¼è½¬æ¢ä¸ºç‹¬çƒ­ç æ ¼å¼ï¼Œæ–¹ä¾¿è®¡ç®—losså’Œaccuracy
            loss = tf.reduce_mean(tf.square(y_ - y))  # é‡‡ç”¨å‡æ–¹è¯¯å·®æŸå¤±å‡½æ•°mse = mean(sum(y-out)^2)
            loss_all += loss.numpy()  # å°†æ¯ä¸ªstepè®¡ç®—å‡ºçš„lossç´¯åŠ ï¼Œä¸ºåç»­æ±‚losså¹³å‡å€¼æä¾›æ•°æ®ï¼Œè¿™æ ·è®¡ç®—çš„lossæ›´å‡†ç¡®

            grads = tape.gradient(loss,[w1,b1])
            w.assign_sub(lr*grads[0])
            b1.assign_sub(lr*grads[1])
        print(&quot;Epoch{},loss:{}&quot;.format(epoch,loss_all/4))</code></pre><h1 id="ğŸè®¡ç®—å‡†ç¡®ç‡"><a href="#ğŸè®¡ç®—å‡†ç¡®ç‡" class="headerlink" title="ğŸè®¡ç®—å‡†ç¡®ç‡"></a>ğŸè®¡ç®—å‡†ç¡®ç‡</h1><pre><code>for x_test,y_test in test_db:
    y = tf.matul(h,w)+b  #é¢„æµ‹ç»“æœ
    y = tf.nn.softmax(y)  #yç¬¦åˆæ¦‚ç‡åˆ†å¸ƒ  
    pred = tf.argmax(y,axis=1) #è¿”å›yä¸­æœ€å¤§å€¼çš„ç´¢å¼•ï¼Œå³é¢„æµ‹çš„åˆ†ç±»  
    pred = tf.cast(pred,dtype = y_test.dtype) #è°ƒæ•´æ•°æ®ç±»å‹ä¸æ ‡ç­¾ä¸€è‡´  
    correct = tf.cast(tf.equal(pred,y_test),dtype = tf.int32)
    correct = tf.reduce_sum(correct) $å°†æ¯ä¸ªbatchçš„correctæ•°åŠ èµ·æ¥
    total_correct +=int(correct)  #å°†æ‰€æœ‰batchä¸­çš„correctæ•°åŠ èµ·æ¥  
    total_number += x_test.shape[0]
acc = total_correct/total_number
print(&quot;test_acc:&quot;,acc)

plt.title(&quot;Acc Curve&quot;)
plt.xlabel(&quot;Epoch&quot;)
plt.ylabel(&quot;Acc&quot;)
plt.plot(test_acc,label=&quot;$Accuracy$&quot;)  
plt.legend()
plt.show()</code></pre>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/01/24/Tensorflow-Anaconda-Pycharm%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/24/Tensorflow-Anaconda-Pycharm%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/" class="post-title-link" itemprop="url">Tensorflow+Anaconda+Pycharmç¯å¢ƒå®‰è£…</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-01-24 15:39:12" itemprop="dateCreated datePublished" datetime="2021-01-24T15:39:12+08:00">2021-01-24</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/12/01/Matlab%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/01/Matlab%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/" class="post-title-link" itemprop="url">MatlabæœŸæœ«å¤ä¹ </a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-12-01 22:32:32" itemprop="dateCreated datePublished" datetime="2020-12-01T22:32:32+08:00">2020-12-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-01-24 15:36:45" itemprop="dateModified" datetime="2021-01-24T15:36:45+08:00">2021-01-24</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="DAY-1"><a href="#DAY-1" class="headerlink" title="DAY 1"></a>DAY 1</h1><ul>
<li><p><strong>å°æ‹¬å·()</strong><br>  åªè¡¨ç¤ºè¿ç®—çº§åˆ«â€”â€”åœ¨è¿ç®—ä¸­ä¼˜å…ˆè®¡ç®—ï¼›è‹¥æœ‰å¤šä¸ªå°æ‹¬å·åˆ™å…ˆç®—æœ€é‡Œé¢çš„ã€‚<br><strong>ä¸­æ‹¬å·[]</strong><br>  åªç”¨äºç”ŸæˆçŸ©é˜µå’Œå‘é‡<br><strong>èŠ±æ‹¬å·{}</strong><br>  ç”Ÿæˆå•å…ƒæ•°ç»„ï¼›åœ¨ç”Ÿæˆç»“æ„ä½“çš„ä¸€ç§æ–¹æ³•<code>struct(&#39;å˜é‡å&#39;,{&#39;å…ƒç´ å&lt;--å¯å¤šä¸ª&#39;},)</code>ä¹Ÿå°±æ˜¯å¦‚æœç”¨<code>struct()</code>é‡Œé¢çš„å…ƒç´ æ˜¯å¤šä¸ªæ—¶ï¼Œå°±ç”¨èŠ±æ‹¬å·åŒ…å«èµ·æ¥    </p>
</li>
<li><p><strong>æ•°ç»„/çŸ©é˜µçš„è¡Œåˆ—</strong><br>  <strong>é€—å·</strong><code>,</code>æ˜¯åŒä¸€è¡Œä¸åŒåˆ—å…ƒç´ åˆ†å¼€<br>  <strong>åˆ†å·</strong><code>;</code>æ˜¯ä¸åŒè¡Œ</p>
<pre><code>&gt;&gt;x=[1, 2 3;5 ,6,4]
1 2 3
5 6 4</code></pre></li>
</ul>
<h1 id="DAY-2"><a href="#DAY-2" class="headerlink" title="DAY 2"></a>DAY 2</h1><h2 id="åŸºæœ¬è¿ç®—å‡½æ•°"><a href="#åŸºæœ¬è¿ç®—å‡½æ•°" class="headerlink" title="åŸºæœ¬è¿ç®—å‡½æ•°"></a>åŸºæœ¬è¿ç®—å‡½æ•°</h2><ul>
<li><p>ä¸‰è§’å‡½æ•°ç›¸å…³  </p>
<ul>
<li><strong>ä¸‰è§’å‡½æ•°</strong>æœ‰ä¸¤ç§å½¢å¼<br>åˆ†åˆ«ä¸ºè®¡ç®—<strong>å¼§åº¦å½¢å¼</strong><code>cos/sin/tan/csc/sec/cot</code>;<br>è®¡ç®—<strong>è§’åº¦å½¢å¼</strong>åœ¨åé¢åŠ <strong>d</strong> <code>cosd/sind/tand/cscd/secd</code>  </li>
<li><strong>åä¸‰è§’å‡½æ•°</strong>åŒæ ·æœ‰ä¸¤ç§å½¢å¼ï¼Œå¦‚æœè¦ç®—<strong>è§’åº¦</strong>å°±åœ¨åé¢åŠ <strong>d</strong><br>åŸºæœ¬å½¢å¼ä¸º<code>acos/asin/atan/acsc/asec...</code><br>è§’åº¦<code>acosd...</code></li>
<li><strong>åŒæ›²å‡½æ•°</strong>ï¼ŒåŒæ›²æ­£/ä½™â€¦å¼¦,å®é™…ä¸Šå°±æ˜¯åœ¨ä¸‰è§’å‡½æ•°(å¼§åº¦åˆ¶)çš„åé¢åŠ <strong>h</strong>;è‹¥æ˜¯<strong>ååŒæ›²å‡½æ•°</strong>åˆ™å†åœ¨å‰é¢åŠ <strong>a</strong>å³å¯ï¼Œæ¯”å¦‚åŒæ›²ä½™å¼¦<code>cosh</code>;ååŒæ›²ä½™å¼¦<code>acosh</code></li>
</ul>
</li>
<li><p>åŸºæœ¬è¿ç®—  </p>
<ul>
<li><p><strong>ä¹˜æ–¹</strong><code>^</code>  </p>
<pre><code>&gt;&gt;2^2
4</code></pre></li>
<li><p><strong>ä»¥eä¸ºåº•çš„å¹‚</strong><code>exp()</code></p>
<pre><code>&gt;&gt;exp(1)
%ç­‰ä»·äºeçš„ä¸€æ¬¡æ–¹   </code></pre></li>
<li><p><strong>æ±‚å¯¹æ•°â€”â€”ä»¥eä¸ºåº•</strong><code>log()</code><br>è‹¥ä¸ºä»¥å…¶ä»–æ•°å­—ä¸ºåº•æ±‚å¯¹æ•°</p>
</li>
<li><p><strong>ç»å¯¹å€¼æ±‚è§£</strong><code>abs()</code></p>
</li>
<li><p><strong>åˆ¤æ–­æ˜¯å¦ä¸ºå¤æ•°</strong><code>isreal()</code></p>
</li>
<li><p><strong>å–æ•´</strong><code>fix()</code></p>
</li>
<li><p><strong>åˆ¤æ–­è´¨æ•°</strong><code>isprime()</code><br>ğŸ“Œæ³¨æ„ï¼Œåªèƒ½åˆ¤æ–­éè´Ÿæ•´æ•°ï¼ä¸èƒ½åˆ¤æ–­æµ®ç‚¹æ•°  </p>
</li>
</ul>
</li>
</ul>
<h1 id="DAY-4"><a href="#DAY-4" class="headerlink" title="DAY 4"></a>DAY 4</h1><h2 id="å¤šé¡¹å¼"><a href="#å¤šé¡¹å¼" class="headerlink" title="å¤šé¡¹å¼"></a>å¤šé¡¹å¼</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/11/20/mnist-%E8%AF%86%E5%88%AB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/11/20/mnist-%E8%AF%86%E5%88%AB/" class="post-title-link" itemprop="url">mnistæ‰‹å†™è¯†åˆ«</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-11-20 18:43:09" itemprop="dateCreated datePublished" datetime="2020-11-20T18:43:09+08:00">2020-11-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-01-15 20:32:55" itemprop="dateModified" datetime="2021-01-15T20:32:55+08:00">2021-01-15</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Prep"><a href="#Prep" class="headerlink" title="Prep"></a>Prep</h1><h2 id="Kerasæ•°æ®é›†â€”â€”â€”MNISTæ‰‹å†™å­—ç¬¦æ•°æ®é›†"><a href="#Kerasæ•°æ®é›†â€”â€”â€”MNISTæ‰‹å†™å­—ç¬¦æ•°æ®é›†" class="headerlink" title="Kerasæ•°æ®é›†â€”â€”â€”MNISTæ‰‹å†™å­—ç¬¦æ•°æ®é›†"></a>Kerasæ•°æ®é›†â€”â€”â€”MNISTæ‰‹å†™å­—ç¬¦æ•°æ®é›†</h2><pre><code>from keras.datasets import mnist
(x_train,y_train),(x_test,y_test) = mnist.load_data()</code></pre><p>è¿”å›çš„ä¸¤ä¸ªå…ƒç»„ï¼š  </p>
<ul>
<li><strong>x_train, x_test:</strong><br>uint8 æ•°ç»„è¡¨ç¤ºçš„ç°åº¦å›¾åƒï¼Œå°ºå¯¸ä¸º (num_samples, 28, 28)ã€‚</li>
<li><strong>y_train, y_test:</strong><br>uint8 æ•°ç»„è¡¨ç¤ºçš„æ•°å­—æ ‡ç­¾ï¼ˆèŒƒå›´åœ¨ 0-9 ä¹‹é—´çš„æ•´æ•°ï¼‰ï¼Œå°ºå¯¸ä¸º (num_samples,)ã€‚</li>
</ul>
<p>æŸ¥çœ‹ä¸€ä¸‹æˆ‘ä»¬çš„æ•°æ®é›†  </p>
<pre><code>(x_train,y_train),(x_test,y_test)=mnist.load_data()
for i in range(9):
plt.subplot(3,3,i+1)
plt.imshow(x_train[i], cmap=&apos;gray&apos;, interpolation=&apos;none&apos;)
plt.title(&quot;Class {}&quot;.format(y_train[i]))

plt.show()</code></pre><p><img src="https://i.loli.net/2020/11/20/mSG7Fi9EABoN83z.png" alt="æ•°æ®é›†éƒ¨åˆ†æ˜¾ç¤º"><br><strong>æ³¨æ„ï¼š<code>plt.imshow()</code>åªæ˜¯å¤„ç†å›¾åƒï¼Œå¹¶ä¸ä¼šæ˜¾ç¤ºå›¾åƒã€‚éœ€è¦åŠ ä¸Š<code>plt.show()</code></strong>  </p>
<p><strong>ğŸ±è¡¥å……:<code>len(çŸ©é˜µ)</code>è¿”å›çš„æ˜¯çŸ©é˜µçš„è¡Œæ•°</strong></p>
<h2 id="æ ‡ç­¾å‡†å¤‡"><a href="#æ ‡ç­¾å‡†å¤‡" class="headerlink" title="æ ‡ç­¾å‡†å¤‡"></a>æ ‡ç­¾å‡†å¤‡</h2><h3 id="One-Hot-ç¼–ç "><a href="#One-Hot-ç¼–ç " class="headerlink" title="One-Hot ç¼–ç "></a>One-Hot ç¼–ç </h3><p>One-Hotç¼–ç ï¼Œåˆç§°ä¸ºä¸€ä½æœ‰æ•ˆç¼–ç ï¼Œä¸»è¦æ˜¯é‡‡ç”¨Nä½çŠ¶æ€å¯„å­˜å™¨æ¥å¯¹Nä¸ªçŠ¶æ€è¿›è¡Œç¼–ç ï¼Œæ¯ä¸ªçŠ¶æ€éƒ½ç”±ä»–ç‹¬ç«‹çš„å¯„å­˜å™¨ä½ï¼Œå¹¶ä¸”åœ¨ä»»æ„æ—¶å€™åªæœ‰ä¸€ä½æœ‰æ•ˆã€‚</p>
<p>One-Hotç¼–ç æ˜¯åˆ†ç±»å˜é‡ä½œä¸ºäºŒè¿›åˆ¶å‘é‡çš„è¡¨ç¤ºã€‚è¿™é¦–å…ˆè¦æ±‚å°†åˆ†ç±»å€¼æ˜ å°„åˆ°æ•´æ•°å€¼ã€‚ç„¶åï¼Œæ¯ä¸ªæ•´æ•°å€¼è¢«è¡¨ç¤ºä¸ºäºŒè¿›åˆ¶å‘é‡ï¼Œé™¤äº†æ•´æ•°çš„ç´¢å¼•ä¹‹å¤–ï¼Œå®ƒéƒ½æ˜¯é›¶å€¼ï¼Œå®ƒè¢«æ ‡è®°ä¸º1ã€‚<br>å®é™…ä¸Šå°±æ˜¯æ ¹æ®æ ·æœ¬æ‰€å…·æœ‰çš„ç‰¹å¾è¿›è¡Œ<code>0/1</code>èµ‹å€¼ã€‚<br>æ¯”å¦‚å¯¹<code>hello world</code>è¿›è¡Œone hotç¼–ç ã€‚è¯¥å¥ç”±å­—æ¯å’Œç©ºæ ¼ç»„æˆã€‚å­—æ¯çš„ç‰¹å¾æœ‰26ä¸ªç‰¹å¾ï¼ŒåŠ ä¸Šç©ºæ ¼åˆ™ä¸€å…±æœ‰27ä¸ªã€‚<br><img src="https://i.loli.net/2020/11/20/Gb6jxhzICdT4sQv.png" alt="ç¤ºä¾‹"><br>å†æ¯”å¦‚è‹¥å¯¹ <strong>[â€œä¸­å›½â€,â€ç¾å›½â€,â€æ—¥æœ¬â€,â€ç¾å›½â€]</strong> è¿›è¡Œç¼–ç ã€‚  </p>
<ul>
<li>ç¡®å®šè¦ç¼–ç çš„å¯¹è±¡â€“ <strong>[â€œä¸­å›½â€,â€ç¾å›½â€,â€æ—¥æœ¬â€,â€ç¾å›½â€]</strong>   </li>
<li>ç¡®å®šåˆ†ç±»å˜é‡â€“<strong>ä¸­å›½  ç¾å›½  æ—¥æœ¬</strong> å…±ä¸‰ç§ç±»åˆ«<br>  å³æ˜¯æœ‰ä¸‰ä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬æœ‰ä¸‰ä¸ªç‰¹å¾ï¼Œå¹¶å°†å…¶è½¬åŒ–ä¸ºäºŒè¿›åˆ¶å‘é‡ã€‚  </li>
</ul>
<p>æˆ‘ä»¬é¦–å…ˆè¿›è¡Œç‰¹å¾çš„æ•´æ•°ç¼–ç ï¼š <strong>ä¸­å›½â€“0ï¼Œç¾å›½â€“1ï¼Œæ—¥æœ¬â€“2</strong> ï¼Œå¹¶å°†ç‰¹å¾æŒ‰ç…§ä»å°åˆ°å¤§æ’åˆ—<br><img src="https://img2018.cnblogs.com/blog/901213/201907/901213-20190730115423074-1198386169.png" alt="ç¤ºä¾‹">  </p>
<p>ğŸ±<strong>Keraså®ç°</strong>   </p>
<pre><code>from keras.utils import np_utils
&gt;&gt;y_train =np_utils.to_categorical(y_train,num_classes=10)  
#åç±»ï¼Œåº”è¯¥æ˜¯ç”¨åä¸ªç‰¹å¾è¿›è¡Œè¡¨ç¤ºï¼Œå‰ææ˜¯y_trainä¸­çš„æ•°å­—æœ€å¤§ä¸èƒ½è¶…è¿‡10ã€‚è¿™å®é™…ä¸Šå¾ˆåƒæ˜¯å¯¹ç‚¹æ ‡ç­¾ï¼Œå¦‚æœæ˜¯5ï¼Œå°±åœ¨5å¤„æ‰“å‹¾(å˜ä¸º1ï¼Œå…¶ä½™ä¸º0)ã€‚æ‰€ä»¥è¦ä¿è¯num_classesè¦å¤§äºmax(y)  </code></pre><h1 id="æ­å»ºç½‘ç»œ"><a href="#æ­å»ºç½‘ç»œ" class="headerlink" title="æ­å»ºç½‘ç»œ"></a>æ­å»ºç½‘ç»œ</h1><p><strong>åˆ›å»ºSequentialæ¨¡å‹</strong>   </p>
<ul>
<li><p>å°†å±‚çš„åˆ—è¡¨ä¼ é€’ç»™Sequentialçš„æ„é€ å‡½æ•°ã€‚   </p>
<pre><code>model = Sequential([
 Dense(units = 10,input_dim = 784,bias_initializer = &apos;one&apos;,activation=&apos;softmax&apos;)]) </code></pre></li>
<li><p>ä½¿ç”¨<code>model.add()</code>çš„æ–¹æ³•å°†å„å±‚æ·»åŠ åˆ°æ¨¡å‹ä¸­  </p>
</li>
</ul>
<pre><code>model = Sequential()
model.add(Dense(10, input_dim=784))
model.add(Activation(&apos;softmax&apos;))  </code></pre><p><strong>Dense</strong><br><img src="https://i.loli.net/2020/11/20/FaNRyqT3n1CApVs.png" alt=""></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/10/28/python%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94%E7%B1%BB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/28/python%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94%E7%B1%BB/" class="post-title-link" itemprop="url">pythonå­¦ä¹ â€”â€”ç±»</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-10-28 22:39:14" itemprop="dateCreated datePublished" datetime="2020-10-28T22:39:14+08:00">2020-10-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-30 22:56:10" itemprop="dateModified" datetime="2020-10-30T22:56:10+08:00">2020-10-30</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="å®šä¹‰ç±»"><a href="#å®šä¹‰ç±»" class="headerlink" title="å®šä¹‰ç±»"></a>å®šä¹‰ç±»</h1><pre><code>class Student(object):
    pass</code></pre><p>classåé¢ç´§è·Ÿç€çš„å°±æ˜¯ç±»åï¼Œå³<code>Student</code> ï¼Œåé¢ç´§æ¥ç€çš„<code>(object)</code>è¡¨ç¤ºè¯¥ç±»æ˜¯ä»å“ªä¸ªç±»ç»§æ‰¿ä¸‹æ¥çš„ã€‚<br>    å¦‚æœæ²¡æœ‰åˆé€‚çš„ç»§æ‰¿ç±»ï¼Œå°±ç”¨<code>object</code>ç±»ï¼Œè¿™æ˜¯æ‰€æœ‰ç±»éƒ½ä¼šç»§æ‰¿çš„ç±»ã€‚  </p>
<h1 id="åˆ›å»ºå®ä¾‹"><a href="#åˆ›å»ºå®ä¾‹" class="headerlink" title="åˆ›å»ºå®ä¾‹"></a>åˆ›å»ºå®ä¾‹</h1><p>åˆ›å»ºå®ä¾‹ç›´æ¥<code>example = Student(parameter)</code><br>å¦‚æœåœ¨ç±»çš„å®šä¹‰ä¸­æ²¡æœ‰ç»‘å®šå±æ€§ã€‚ä¹Ÿå°±æ˜¯åœ¨æˆ‘ä»¬å®šä¹‰ç±»çš„æ—¶å€™ï¼Œæˆ‘ä»¬è§„å®šï¼Œæ‰€æœ‰å®ä¾‹éƒ½å¿…é¡»å…·æœ‰ä¸€äº›å±æ€§ï¼Œå°±å¯ä»¥åœ¨å®šä¹‰ç±»æ—¶ç»‘å®šå±æ€§ã€‚<br>å¦‚æœä¸ç»‘å®šå±æ€§ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚é‚£ä¹ˆå°±ä¸ä¼ å…¥å‚æ•°<code>example = Student()</code><br>æ­¤æ—¶ï¼Œå¯ä»¥è‡ªç”±å®šä¹‰å±æ€§ <strong><em>(ç»‘å®šäº†å±æ€§ä¹Ÿæ˜¯å¯ä»¥è‡ªç”±å®šä¹‰ï¼Œåªæ˜¯åœ¨äºï¼Œå¦‚æœäº†ç»‘å®šäº†ï¼Œå°±ç›¸å½“äºè§„å®šäº†åœ¨æˆ‘å®šä¹‰è¿™ä¸ªå®ä¾‹æ—¶ï¼Œå°±å¿…é¡»è¦å…·æœ‰è¿™äº›å±æ€§)</em></strong>   </p>
<pre><code>&gt;&gt;&gt; amy = Student()
&gt;&gt;&gt; amy.name=&quot;Amy Smith&quot;
&gt;&gt;&gt; amy.name
&apos;Amy Smith&apos;</code></pre><p>å¦‚æœåœ¨ç±»ä¸­ç»‘å®šäº†å±æ€§   </p>
<pre><code>class Student():
    def __init__(self,name,score):
        self.name=name
        self.score=score</code></pre><p><strong>æ³¨é‡Šï¼š</strong> åœ¨ç±»ä¸­ç»‘å®šå±æ€§ï¼Œå°±æ˜¯é€šè¿‡å®šä¹‰ä¸€ä¸ªç‰¹æ®Šçš„æ–¹æ³•<code>__init__</code>ï¼Œå…¶ç¬¬ä¸€ä¸ªå‚æ•°  <strong><em>(åŒ…æ‹¬åé¢æ‰€æœ‰åœ¨ç±»ä¸­å®šä¹‰çš„æ–¹æ³•)</em></strong> éƒ½æ˜¯<code>self</code>ã€‚å› ä¸º<code>self</code>å°±æŒ‡å‘åˆ›å»ºçš„å®ä¾‹æœ¬èº«ã€‚å…¶åçš„å‚æ•°å°±æ˜¯æˆ‘ä»¬ç»‘å®šçš„å±æ€§ã€‚   </p>
<p>æ­¤ååœ¨åˆ›å»ºå®ä¾‹æ—¶ï¼Œå°±è¦ä¼ å…¥ç›¸åº”çš„å‚æ•°ã€‚   </p>
<pre><code>&gt;&gt;&gt; amy = Student(&quot;Amy Smith&quot;,95)
&gt;&gt;&gt; amy.name
&quot;Amy Smith&quot;  </code></pre><p>å½“ç„¶å±æ€§ä¹Ÿä¸æ˜¯ä¸€å±‚ä¸å˜çš„ã€‚<br>æˆ‘ä»¬å¯ä»¥æ›´æ”¹å±æ€§å€¼ã€‚  </p>
<pre><code>&gt;&gt;&gt;amy.name=&quot;Tony&quot;  
&gt;&gt;&gt;amy.name
&quot;Tony&quot;</code></pre><p>ä¹Ÿå°±æ˜¯è¯´å¤–éƒ¨ä»£ç å¯ä»¥è‡ªç”±åœ°ä¿®æ”¹å®ä¾‹çš„å±æ€§ã€‚  </p>
<p>ğŸ“Œå¦‚æœè¦è®©å†…éƒ¨å±æ€§ä¸è¢«å¤–éƒ¨è®¿é—®ï¼Œå¯ä»¥æŠŠå±æ€§çš„åç§°å‰åŠ ä¸¤ä¸ªä¸‹åˆ’çº¿<code>__</code>ï¼Œæ­¤æ—¶å¦‚æœå®ä¾‹çš„å˜é‡åä»¥<code>___</code>å¼€å¤´ï¼Œå°±å˜æˆä¸€ä¸ªç§æœ‰å˜é‡ï¼Œåªæœ‰å†…éƒ¨å¯ä»¥è®¿é—®ï¼Œå¤–éƒ¨ä¸èƒ½è®¿é—®<br><img src="https://i.loli.net/2020/10/30/aeglV2YkQhDmu9B.png" alt="ç¤ºä¾‹">   </p>
<p><strong>æ³¨ï¼š</strong> å®é™…ä¸Šå¹¶ä¸æ˜¯å¤–éƒ¨ä¸èƒ½è®¿é—®äº†ï¼Œè€Œæ˜¯Pythonè§£é‡Šå™¨å°†<code>__name</code>å˜æˆäº†<code>_Student__name</code>  </p>
<p><img src="https://i.loli.net/2020/10/30/ZU9kohD1uGCKSQz.png" alt="ç¤ºä¾‹"><br>å¯ä»¥çœ‹åˆ°é€šè¿‡æˆ‘ä»¬å®šä¹‰çš„æ–¹æ³•å¯ä»¥è¿›è¡Œè®¿é—®ã€ä¿®æ”¹å±æ€§ã€‚ä¹Ÿå¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä»ç„¶æ˜¯å¯ä»¥è®¿é—®ç§æœ‰å˜é‡çš„ï¼Œåªæ˜¯å…¶åå­—å˜äº†ã€‚<br>åŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œåœ¨å…¶ä¸­çš„<code>jack.__name=&#39;mike&#39;</code> å®é™…ä¸Šå¹¶æ²¡æœ‰å®ç°è®¿é—®<code>__name</code>å˜é‡ï¼Œè€Œæ˜¯è‡ªå·±åˆåˆ›äº†ä¸€ä¸ªå±æ€§ï¼Œè¿™ä¸ªå±æ€§çš„åå­—æ˜¯<code>__name</code>ï¼Œå…¶å€¼æ˜¯<code>&#39;mike&#39;</code>   </p>
<p><strong>è¡¥å……ï¼š</strong> åœ¨Pythonä¸­ï¼Œå˜é‡åç±»ä¼¼<code>__xx__</code>çš„ï¼Œæ˜¯ç‰¹æ®Šå˜é‡ï¼Œæ˜¯å¯ä»¥ç›´æ¥è®¿é—®çš„ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/10/20/opencv-%E4%B8%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/20/opencv-%E4%B8%80/" class="post-title-link" itemprop="url">opencv(ä¸€)</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-10-20 22:57:31" itemprop="dateCreated datePublished" datetime="2020-10-20T22:57:31+08:00">2020-10-20</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/10/07/Tensorflow%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%B8%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/07/Tensorflow%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%B8%80/" class="post-title-link" itemprop="url">Tensorflowå­¦ä¹ ç¬”è®°(ä¸€)</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-10-07 16:09:09" itemprop="dateCreated datePublished" datetime="2020-10-07T16:09:09+08:00">2020-10-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-02-18 19:15:51" itemprop="dateModified" datetime="2021-02-18T19:15:51+08:00">2021-02-18</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Tensorflowçš„ç»“æ„"><a href="#Tensorflowçš„ç»“æ„" class="headerlink" title="Tensorflowçš„ç»“æ„"></a>Tensorflowçš„ç»“æ„</h1><p>Tensorflowä¸»è¦ç”±ä¸¤ä¸ªéƒ¨åˆ†è¿›è¡Œï¼Œä¸€ä¸ªæ˜¯å®šä¹‰è®¡ç®—å›¾ï¼Œä¸€ä¸ªæ˜¯æ‰§è¡Œè®¡ç®—å›¾ã€‚<br>åœ¨æ„å»ºè®¡ç®—å›¾ä¸­ï¼Œè¦å®šä¹‰æ‰€æœ‰ä½¿ç”¨çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯å¼ é‡(tensor)å¯¹è±¡(å¸¸é‡ã€å˜é‡å’Œå ä½ç¬¦)ï¼ŒåŒæ—¶ï¼Œå®šä¹‰è¦æ‰§è¡Œçš„æ‰€æœ‰è®¡ç®—ï¼Œå³è¿ç®—æ“ä½œå¯¹è±¡(Operation Object,ç®€ç§°OP)</p>
<h1 id="å®šä¹‰è®¡ç®—å›¾"><a href="#å®šä¹‰è®¡ç®—å›¾" class="headerlink" title="å®šä¹‰è®¡ç®—å›¾"></a>å®šä¹‰è®¡ç®—å›¾</h1><h2 id="å¼ é‡"><a href="#å¼ é‡" class="headerlink" title="å¼ é‡"></a>å¼ é‡</h2><ul>
<li>å¼ é‡<ul>
<li>æ ‡é‡</li>
<li>å‘é‡</li>
<li>çŸ©é˜µ</li>
<li>å¼ é‡</li>
</ul>
</li>
</ul>
<h3 id="å¸¸é‡"><a href="#å¸¸é‡" class="headerlink" title="å¸¸é‡"></a>å¸¸é‡</h3><pre><code># å®šä¹‰å¸¸é‡çŸ©é˜µ
&gt;&gt;tf.constant([])

#åˆ›å»ºå…¨ä¸º0/1çš„å¼ é‡
&gt;&gt;tf.zeros([M,N],tf.dtype)
# tf.dtypeå¯ä»¥æ˜¯tf.int32ã€tf.float32ç­‰
&gt;&gt;tf.ones([M,N],tf.dtype)

#åœ¨ä¸€å®šèŒƒå›´å†…ç”Ÿæˆä»åˆå€¼åˆ°ç»ˆå€¼çš„ç­‰å·®æ•°åˆ—(åŒ…å«ç»ˆå€¼)
&gt;&gt;tf.linspace(start,stop,num)
# ğŸ‘†å…¬å·®ä¸º (stop-start)/(num-1)

#ä»å¼€å§‹ï¼ˆé»˜è®¤å€¼=0ï¼‰ç”Ÿæˆä¸€ä¸ªæ•°å­—åºåˆ—ï¼Œå¢é‡ä¸º deltaï¼ˆé»˜è®¤å€¼=1ï¼‰ï¼Œç›´åˆ°ç»ˆå€¼ï¼ˆä½†ä¸åŒ…æ‹¬ç»ˆå€¼ï¼‰
&gt;&gt;tf.range(start,limit,delta)</code></pre><h1 id="å¸¸ç”¨å‡½æ•°"><a href="#å¸¸ç”¨å‡½æ•°" class="headerlink" title="å¸¸ç”¨å‡½æ•°"></a>å¸¸ç”¨å‡½æ•°</h1><h2 id="tf-where"><a href="#tf-where" class="headerlink" title="tf.where()"></a>tf.where()</h2><pre><code>tf.where(æ¡ä»¶è¯­å¥ï¼ŒçœŸè¿”å›Aï¼Œå‡è¿”å›B)

&gt;&gt; a=tf.constant([1,2,3,1,1])
&gt;&gt; b=tf.constant([0,1,3,4,5])
&gt;&gt; c=tf.where(tf.greater(a,b),a,b)
#è¯¥ä½ç½®ä¸Šè‹¥a&gt;bï¼Œåˆ™ä¸ºçœŸ  
&gt;&gt; print(&quot;c:&quot;,c)

...

c:tf.Tensor([1 2 3 4 5],shape=(5,),dtype=int32)</code></pre><h2 id="np-random-RandomState-rand"><a href="#np-random-RandomState-rand" class="headerlink" title="np.random.RandomState.rand()"></a>np.random.RandomState.rand()</h2><pre><code>#è¿”å›ä¸€ä¸ª[0,1)ä¹‹é—´çš„éšæœºæ•°
np.random.RandomState.rand(ç»´åº¦)
#è‹¥ç»´åº¦ä¸ºç©ºï¼Œè¿”å›æ ‡é‡   

import numpy as np
rdm = np.random.RandomState(seed=1)  
a=rdm.rand() #è¿”å›ä¸€ä¸ªéšæœºæ ‡é‡
b=rdm.rand(2,3) #è¿”å›ç»´åº¦ä¸º2*3çš„éšæœºæ•°çŸ©é˜µ  </code></pre><h2 id="np-vstack"><a href="#np-vstack" class="headerlink" title="np.vstack()"></a>np.vstack()</h2><pre><code>#å°†ä¸¤ä¸ªæ•°ç»„æŒ‰å‚ç›´æ–¹å‘å åŠ 
np.vstack(æ•°ç»„1ï¼Œæ•°ç»„2)

import numpy as np
a=np.array([1,2,3])
b=np.array([4,5,6])
c=np.vstack((a,b))

...

c:
[[1,2,3]
[4,5,6]]</code></pre><h2 id="ç”Ÿæˆç½‘æ ¼åæ ‡ç‚¹"><a href="#ç”Ÿæˆç½‘æ ¼åæ ‡ç‚¹" class="headerlink" title="ç”Ÿæˆç½‘æ ¼åæ ‡ç‚¹"></a>ç”Ÿæˆç½‘æ ¼åæ ‡ç‚¹</h2><pre><code>np.mgrid[èµ·å§‹å€¼:ç»“æŸå€¼:æ­¥é•¿,èµ·å§‹å€¼:ç»“æŸå€¼:æ­¥é•¿,....] 
#è¿”å›è‹¥å¹²ç»„ç»´åº¦ç›¸åŒçš„ç­‰å·®æ•°ç»„
#[èµ·å§‹å€¼,ç»“æŸå€¼) å‰é—­åå¼€
#å½“æ­¥é•¿æ˜¯å¤æ•°æ—¶ï¼Œæ¯”å¦‚3j,è¡¨ç¤ºç‚¹æ•°ï¼Œå³æ˜¯åœ¨è¯¥åŒºé—´å–ä¸‰ä¸ªå€¼ï¼›å¦å¤–ï¼Œæ­¤æ—¶æ­¥é•¿æ˜¯å¤æ•°æ—¶ï¼ŒåŒºé—´å·¦é—­å³é—­



x.ravel() #å°†xå˜ä¸ºä¸€ç»´æ•°ç»„  


np.c_[] #ä½¿è¿”å›çš„é—´éš”æ•°å€¼ç‚¹é…å¯¹  </code></pre><p><img src="https://i.loli.net/2021/02/06/wypDIYAx7bE4Zvo.png" alt="image.png"></p>
<h1 id="ç¥ç»ç½‘ç»œ-NN-å¤æ‚åº¦"><a href="#ç¥ç»ç½‘ç»œ-NN-å¤æ‚åº¦" class="headerlink" title="ç¥ç»ç½‘ç»œ(NN)å¤æ‚åº¦"></a>ç¥ç»ç½‘ç»œ(NN)å¤æ‚åº¦</h1><ol>
<li><p>NNå¤æ‚åº¦ </p>
<ul>
<li>å¤šç”¨NNå±‚æ•°å’ŒNNå‚æ•°çš„ä¸ªæ•°è¡¨ç¤º  </li>
</ul>
</li>
<li><p>ç©ºé—´å¤æ‚åº¦(ç”¨å±‚æ•°å’Œä¼˜åŒ–å‚æ•°ä¸ªæ•°è¡¨ç¤º)</p>
<ul>
<li><p>å±‚æ•° = éšè—å±‚æ•°+1ä¸ªè¾“å‡ºå±‚</p>
<ul>
<li>åªç»Ÿè®¡å…·æœ‰è¿ç®—èƒ½åŠ›çš„å±‚</li>
<li>è¾“å…¥å±‚åªæŠŠæ•°æ®ä¼ è¾“è¿‡æ¥ï¼Œä¸å…·æœ‰è¿ç®—èƒ½åŠ›  </li>
</ul>
</li>
<li><p>æ€»å‚æ•° = æ€»w + æ€»b  </p>
</li>
</ul>
</li>
<li><p>æ—¶é—´å¤æ‚åº¦  </p>
<ul>
<li>ä¹˜åŠ è¿ç®—æ¬¡æ•°</li>
</ul>
</li>
</ol>
<p><img src="https://i.loli.net/2021/02/06/sJePNvzj4UfugiX.png" alt="image.png"></p>
<h1 id="æŒ‡æ•°è¡°å‡å­¦ä¹ ç‡"><a href="#æŒ‡æ•°è¡°å‡å­¦ä¹ ç‡" class="headerlink" title="æŒ‡æ•°è¡°å‡å­¦ä¹ ç‡"></a>æŒ‡æ•°è¡°å‡å­¦ä¹ ç‡</h1><p>æŒ‡æ•°è¡°å‡å­¦ä¹ ç‡ =  åˆå§‹å­¦ä¹ ç‡*å­¦ä¹ è¡°å‡ç‡^(å½“å‰è½®æ•°/å¤šå°‘è½®è¡°å‡ä¸€æ¬¡)</p>
<blockquote>
<p>æ ¹æ®è¿­ä»£æ¬¡æ•°æ›´æ–°   </p>
</blockquote>
<p><img src="https://i.loli.net/2021/02/06/sKYm1a8Ric3CXfI.png" alt="image.png"><br><img src="https://i.loli.net/2021/02/06/DBdMaCgeq549XtK.png" alt="image.png"></p>
<h1 id="æ¿€æ´»å‡½æ•°"><a href="#æ¿€æ´»å‡½æ•°" class="headerlink" title="æ¿€æ´»å‡½æ•°"></a>æ¿€æ´»å‡½æ•°</h1><h2 id="Sigmoidå‡½æ•°-tf-nn-sigmoid-x"><a href="#Sigmoidå‡½æ•°-tf-nn-sigmoid-x" class="headerlink" title="Sigmoidå‡½æ•°  tf.nn.sigmoid(x)"></a>Sigmoidå‡½æ•°  tf.nn.sigmoid(x)</h2><ul>
<li>èŒƒå›´ä¸º<code>(0,1)</code>ï¼Œä»¥0.5ä¸ºç•Œé™ã€‚x=0æ—¶ï¼Œf(x)=0.5  </li>
</ul>
<p><img src="https://i.loli.net/2021/02/06/vgbhIzGCJ3YTOiu.png" alt="image.png"></p>
<h3 id="æ³¨é‡Šä¸€ä¸‹"><a href="#æ³¨é‡Šä¸€ä¸‹" class="headerlink" title="æ³¨é‡Šä¸€ä¸‹"></a>æ³¨é‡Šä¸€ä¸‹</h3><ul>
<li>æ¢¯åº¦æ¶ˆå¤±<br>  å› ä¸ºå¯¼æ•°è¾“å‡ºæ˜¯0-0.25ä¹‹é—´çš„å°æ•°ï¼Œå¤šä¸ªå¯¼æ•°ç›¸ä¹˜ä¼šé€ æˆè¶‹äºé›¶çš„ç»“æœï¼Œä½¿å¾—å‚æ•°æ— æ³•ç»§ç»­æ›´æ–°ã€‚</li>
<li>è¾“å‡ºé0å‡å€¼ï¼Œæ”¶æ•›æ…¢<br>  æˆ‘ä»¬å¸Œæœ›è¾“å…¥æ¯å±‚ç¥ç»ç½‘ç»œçš„ç‰¹å¾æ˜¯ä»¥0ä¸ºå‡å€¼çš„å°æ•°ï¼Œä½†ç»è¿‡sigmoidå‡½æ•°åçš„æ•°æ®éƒ½æ˜¯æ•´æ•°ï¼Œä¼šä½¿æ”¶æ•›å˜æ…¢</li>
<li>å­˜åœ¨å¹‚è¿ç®—ï¼Œè®­ç»ƒå¤æ‚åº¦å¤§ï¼Œè®­ç»ƒæ—¶é—´é•¿</li>
</ul>
<h2 id="Tanhå‡½æ•°-tf-math-tanh-x"><a href="#Tanhå‡½æ•°-tf-math-tanh-x" class="headerlink" title="Tanhå‡½æ•°  tf.math.tanh(x)"></a>Tanhå‡½æ•°  tf.math.tanh(x)</h2><p><img src="https://i.loli.net/2021/02/17/4wFYjo87RWTUCfN.png" alt="image.png">  </p>
<h3 id="æ³¨é‡Šä¸€ä¸‹-1"><a href="#æ³¨é‡Šä¸€ä¸‹-1" class="headerlink" title="æ³¨é‡Šä¸€ä¸‹"></a>æ³¨é‡Šä¸€ä¸‹</h3><ul>
<li>è¾“å‡ºä¸º0å‡å€¼  </li>
<li>ä»å­˜åœ¨æ¢¯åº¦æ¶ˆå¤±</li>
<li>å¹‚è¿ç®—å¤æ‚ï¼Œè®­ç»ƒæ—¶é—´é•¿</li>
</ul>
<h2 id="Reluå‡½æ•°-tf-nn-relu-x"><a href="#Reluå‡½æ•°-tf-nn-relu-x" class="headerlink" title="Reluå‡½æ•°  tf.nn.relu(x)"></a>Reluå‡½æ•°  tf.nn.relu(x)</h2><p><img src="https://i.loli.net/2021/02/17/b8j6mnpXuRYArvH.png" alt="image.png"></p>
<h3 id="æ³¨é‡Šä¸€ä¸‹-2"><a href="#æ³¨é‡Šä¸€ä¸‹-2" class="headerlink" title="æ³¨é‡Šä¸€ä¸‹"></a>æ³¨é‡Šä¸€ä¸‹</h3><ul>
<li>Dead ReIUé—®é¢˜<br>  é€å…¥æ¿€æ´»å‡½æ•°çš„è¾“å…¥ç‰¹å¾ä¸ºè´Ÿæ•°æ—¶ï¼Œæ¿€æ´»å‡½æ•°è¾“å‡ºæ˜¯0ï¼Œåå‘ä¼ æ’­å¾—åˆ°çš„æ¢¯åº¦æ˜¯0ï¼Œå¯¼è‡´å‚æ•°æ— æ³•æ›´æ–°ï¼Œé€ æˆç¥ç»å…ƒæ­»äº¡ã€‚</li>
</ul>
<h2 id="Leak-Reluå‡½æ•°-tf-nn-leaky-relu-x"><a href="#Leak-Reluå‡½æ•°-tf-nn-leaky-relu-x" class="headerlink" title="Leak Reluå‡½æ•°  tf.nn.leaky_relu(x)"></a>Leak Reluå‡½æ•°  tf.nn.leaky_relu(x)</h2><p><img src="https://i.loli.net/2021/02/17/Ukz74xtiGbX1sNv.png" alt="image.png">   </p>
<p><img src="https://i.loli.net/2021/02/17/JZBIFmjC3z5Wvyu.png" alt="image.png"></p>
<h1 id="æŸå¤±å‡½æ•°"><a href="#æŸå¤±å‡½æ•°" class="headerlink" title="æŸå¤±å‡½æ•°"></a>æŸå¤±å‡½æ•°</h1><p>å®šä¹‰ï¼šé¢„æµ‹å€¼ä¸æ ‡å‡†å€¼çš„å·®</p>
<p>ä¸»æµçš„MSE<code>loss = tf.reduce_mean(tf.square(y_data-y_train))</code>   </p>
<p><img src="https://i.loli.net/2021/02/17/oYmRFv9Tya7eDSu.png" alt="image.png"></p>
<h2 id="MSEä¾‹å­"><a href="#MSEä¾‹å­" class="headerlink" title="MSEä¾‹å­"></a>MSEä¾‹å­</h2><pre><code>import tensorflow as tf
import numpy as np
from matplotlib import pyplot as plt

SEED = 23455

rdm = np.random.RandomState(seed=SEED)  # ç”Ÿæˆ[0,1)ä¹‹é—´çš„éšæœºæ•°
x = rdm.rand(32, 2)
y_ = [[x1 + x2 + (rdm.rand() / 10.0 - 0.05)] for (x1, x2) in x]  # ç”Ÿæˆå™ªå£°[0,1)/10=[0,0.1); [0,0.1)-0.05=[-0.05,0.05)
x = tf.cast(x, dtype=tf.float32)

w1 = tf.Variable(tf.random.normal([2, 1], stddev=1, seed=1))

epoch = 15000
lr = 0.002
loss = []

for epoch in range(epoch):
    with tf.GradientTape() as tape:
        y = tf.matmul(x, w1)  # y = w1*x1+w2*x2
        loss_mse = tf.reduce_mean(tf.square(y_ - y))
        loss.append(loss_mse.numpy())
    grads = tape.gradient(loss_mse, w1)
    w1.assign_sub(lr * grads)

    if epoch % 500 == 0:
        print(&quot;After %d training steps,w1 is &quot; % (epoch))
        print(w1.numpy(), &quot;\n&quot;)
print(&quot;Final w1 is: &quot;, w1.numpy())

y = tf.matmul(x,w1)

plt.subplot(2,2,1)
plt.title(&apos;Loss&apos;)
plt.plot(loss)

plt.subplot(2,2,2)
plt.title(&apos;y_/y&apos;)
plt.plot(y.numpy(),&apos;r-&apos;)
plt.plot(y_,&apos;k-&apos;)


plt.subplot(2,2,3)
plt.title(&apos;y_&apos;)
# plt.plot(y.numpy(),&apos;r-&apos;)
plt.plot(y_,&apos;k-&apos;)


plt.subplot(2,2,4)
plt.title(&apos;y&apos;)
plt.plot(y.numpy(),&apos;r-&apos;)
# plt.plot(y_,&apos;k-&apos;)

plt.show()</code></pre><p><img src="https://i.loli.net/2021/02/17/jAS5IJNMO2CGXVZ.png" alt="image.png"></p>
<h2 id="è‡ªå®šä¹‰"><a href="#è‡ªå®šä¹‰" class="headerlink" title="è‡ªå®šä¹‰"></a>è‡ªå®šä¹‰</h2><p>åœ¨åˆšåˆšçš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç”¨MSEä½œä¸ºæŸå¤±å‡½æ•°ï¼Œé»˜è®¤çš„æ˜¯æ— è®ºæ˜¯é¢„æµ‹å¤šäº†è¿˜æ˜¯å°‘äº†ï¼ŒæŸå¤±æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿå°±æ˜¯ä¸ç®¡é¢„æµ‹é”€é‡å°‘ï¼Œè¿˜æ˜¯é¢„æµ‹é”€é‡å¤šï¼ŒæŸå¤±æ˜¯ä¸€æ ·çš„ã€‚<br>ç„¶è€Œï¼Œå½“æˆ‘ä»¬é¢„æµ‹çš„é”€é‡å¤šæ—¶ï¼Œæˆ‘ä»¬å°±ç›¸å½“äºä¼šå¤šè´­è¿›ï¼ŒæŸå¤±çš„æ˜¯æˆæœ¬ï¼›å½“æˆ‘ä»¬é¢„æµ‹çš„é”€é‡å°‘æ—¶ï¼Œæˆ‘ä»¬å°±å°‘å–äº†ï¼ŒæŸå¤±çš„æ˜¯åˆ©æ¶¦ã€‚<br>è‹¥æˆæœ¬â‰ åˆ©æ¶¦ï¼Œåˆ™MSEäº§ç”Ÿçš„lossæ— æ³•ä½¿åˆ©ç›Šæœ€å¤§åŒ–ã€‚   </p>
<p><img src="https://i.loli.net/2021/02/17/MsYyFvQAtWu847x.png" alt="image.png"></p>
<pre><code>import tensorflow as tf
import numpy as np

SEED = 23455
COST = 1
PROFIT = 99

rdm = np.random.RandomState(SEED)
x = rdm.rand(32, 2)
y_ = [[x1 + x2 + (rdm.rand() / 10.0 - 0.05)] for (x1, x2) in x]  # ç”Ÿæˆå™ªå£°[0,1)/10=[0,0.1); [0,0.1)-0.05=[-0.05,0.05)
x = tf.cast(x, dtype=tf.float32)

w1 = tf.Variable(tf.random.normal([2, 1], stddev=1, seed=1))

epoch = 10000
lr = 0.002

for epoch in range(epoch):
    with tf.GradientTape() as tape:
        y = tf.matmul(x, w1)
        loss = tf.reduce_sum(tf.where(tf.greater(y, y_), (y - y_) * COST, (y_ - y) * PROFIT))

    grads = tape.gradient(loss, w1)
    w1.assign_sub(lr * grads)

    if epoch % 500 == 0:
        print(&quot;After %d training steps,w1 is &quot; % (epoch))
        print(w1.numpy(), &quot;\n&quot;)
print(&quot;Final w1 is: &quot;, w1.numpy())

# è‡ªå®šä¹‰æŸå¤±å‡½æ•°
# é…¸å¥¶æˆæœ¬1å…ƒï¼Œ é…¸å¥¶åˆ©æ¶¦99å…ƒ
# æˆæœ¬å¾ˆä½ï¼Œåˆ©æ¶¦å¾ˆé«˜ï¼Œäººä»¬å¸Œæœ›å¤šé¢„æµ‹äº›ï¼Œç”Ÿæˆæ¨¡å‹ç³»æ•°å¤§äº1ï¼Œå¾€å¤šäº†é¢„æµ‹</code></pre><h2 id="CE-tf-losses-categorical-crossentropy-y-y"><a href="#CE-tf-losses-categorical-crossentropy-y-y" class="headerlink" title="CE tf.losses.categorical_crossentropy(y_,y)"></a>CE tf.losses.categorical_crossentropy(y_,y)</h2><p>äº¤å‰ç†µè¶Šå¤§ï¼Œä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒè¶Šè¿œï¼›<br>äº¤å‰ç†µè¶Šå°ï¼Œä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒè¶Šè¿‘ã€‚</p>
<p>ä¸€èˆ¬å…ˆç”¨<code>softmax()</code>å‡½æ•°è®©è¾“å‡ºç»“æœç¬¦åˆæ¦‚ç‡åˆ†å¸ƒï¼Œå†æ±‚äº¤å‰ç†µæŸå¤±å‡½æ•°ã€‚<br>Tensorflowç»™å‡ºä¸€ä¸ªå¯ä»¥åŒæ—¶è®¡ç®—æ¦‚ç‡åˆ†å¸ƒå’Œäº¤å‰ç†µå‡½æ•°<code>tf.nn.softmax_cross_entropy_with_logits(y_,y)</code></p>
<p><img src="https://i.loli.net/2021/02/17/36jG2strdzcwTDC.png" alt="image.png"></p>
<pre><code># softmaxä¸äº¤å‰ç†µæŸå¤±å‡½æ•°çš„ç»“åˆ
import tensorflow as tf
import numpy as np

y_ = np.array([[1, 0, 0], [0, 1, 0], [0, 0, 1], [1, 0, 0], [0, 1, 0]])
y = np.array([[12, 3, 2], [3, 10, 1], [1, 2, 5], [4, 6.5, 1.2], [3, 6, 1]])
y_pro = tf.nn.softmax(y)
loss_ce1 = tf.losses.categorical_crossentropy(y_,y_pro)
loss_ce2 = tf.nn.softmax_cross_entropy_with_logits(y_, y)

print(&apos;åˆ†æ­¥è®¡ç®—çš„ç»“æœ:\n&apos;, loss_ce1)
print(&apos;ç»“åˆè®¡ç®—çš„ç»“æœ:\n&apos;, loss_ce2)


# è¾“å‡ºçš„ç»“æœç›¸åŒ</code></pre><p><img src="https://i.loli.net/2021/02/17/RNZxG5EtKVnpych.png" alt="image.png"></p>
<h1 id="æ¬ æ‹Ÿåˆä¸è¿‡æ‹Ÿåˆ"><a href="#æ¬ æ‹Ÿåˆä¸è¿‡æ‹Ÿåˆ" class="headerlink" title="æ¬ æ‹Ÿåˆä¸è¿‡æ‹Ÿåˆ"></a>æ¬ æ‹Ÿåˆä¸è¿‡æ‹Ÿåˆ</h1><ul>
<li>æ¬ æ‹Ÿåˆçš„è§£å†³æ–¹æ³•ï¼š  <ul>
<li>å¢åŠ è¾“å…¥ç‰¹å¾é¡¹</li>
<li>å¢åŠ ç½‘ç»œå‚æ•°</li>
<li>å‡å°‘æ­£åˆ™åŒ–å‚æ•° </li>
</ul>
</li>
<li>è¿‡æ‹Ÿåˆçš„è§£å†³æ–¹æ³•  <ul>
<li>æ•°æ®æ¸…æ´—<br>  å‡å°‘æ•°æ®é›†ä¸­çš„å™ªå£°</li>
<li>å¢å¤§è®­ç»ƒé›†    </li>
<li>é‡‡ç”¨æ­£åˆ™åŒ–</li>
<li>å¢å¤§æ­£åˆ™åŒ–å‚æ•°</li>
</ul>
</li>
</ul>
<p><img src="https://i.loli.net/2021/02/17/2Blo7SGeLCDkpt5.png" alt="image.png"></p>
<pre><code># å·²çŸ¥ä¸¤ä¸ªç‰¹å¾ï¼Œå¯¹åº”ä¸€ä¸ªæ ‡ç­¾yï¼Œä¸º1æˆ–è€…0
# é€šè¿‡è®­ç»ƒï¼Œä½¿å¾—ï¼Œå†ç»™å‡ºä¸€å¯¹ç‰¹å¾æ—¶ï¼Œåˆ¤æ–­æ˜¯1çš„å¯èƒ½æ€§å¤§è¿˜æ˜¯0çš„å¯èƒ½æ€§å¤§
# æ•°æ®å¯è§†åŒ–
# å°†æ ‡ç­¾ä¸º1çš„ç‚¹æ ‡ä¸ºçº¢è‰²ï¼Œä¸º0çš„ç‚¹æ ‡ä¸ºè“è‰²
# ç¥ç»ç½‘ç»œè¦èƒ½å¤Ÿåˆ’å‡ºä¸€æ¡çº¿æ¥åŒºåˆ†

# æ€è·¯
# 1.è®­ç»ƒç¥ç»ç½‘ç»œï¼Œå¾—åˆ°ç‰¹å¾ä¸æ ‡ç­¾çš„å‡½æ•°å…³ç³»
# 2.é¢„æµ‹æ˜¯å°†æ‰€æœ‰ç”»ç½‘æ ¼ï¼Œè¦†ç›–æ‰€æœ‰ç‚¹ï¼Œå¹¶å°†æ‰€æœ‰ç‚¹éƒ½é¢„æµ‹å‡ºæ¥ï¼Œå°†é¢„æµ‹å€¼ç­‰äº0.5çš„çº¿ç”»å‡ºæ¥ï¼Œè¿™æ¡çº¿å°±æ˜¯æˆ‘ä»¬åŒºåˆ†çš„çº¿


# å¯¼å…¥æ‰€éœ€æ¨¡å—
import tensorflow as tf
from matplotlib import pyplot as plt
import numpy as np
import pandas as pd

# è¯»å…¥æ•°æ®/æ ‡ç­¾ ç”Ÿæˆx_train y_train
df = pd.read_csv(&apos;dot.csv&apos;)
x_data = np.array(df[[&apos;x1&apos;, &apos;x2&apos;]])
y_data = np.array(df[&apos;y_c&apos;])

x_train = x_data
y_train = y_data.reshape(-1, 1) # -1æ˜¯æœªå®šçš„æ„æ€ï¼Œä¹Ÿå°±æ˜¯ä¸ç”¨çœ‹è¿™ä¸€ä¸ªï¼Œä¹Ÿå°±æ˜¯è®²yæ•´ç†æˆä¸€åˆ—

Y_c = [[&apos;red&apos; if y else &apos;blue&apos;] for y in y_train]

print(Y_c)

# è½¬æ¢xçš„æ•°æ®ç±»å‹ï¼Œå¦åˆ™åé¢çŸ©é˜µç›¸ä¹˜æ—¶ä¼šå› æ•°æ®ç±»å‹é—®é¢˜æŠ¥é”™
x_train = tf.cast(x_train, tf.float32)
y_train = tf.cast(y_train, tf.float32)

# from_tensor_sliceså‡½æ•°åˆ‡åˆ†ä¼ å…¥çš„å¼ é‡çš„ç¬¬ä¸€ä¸ªç»´åº¦ï¼Œç”Ÿæˆç›¸åº”çš„æ•°æ®é›†ï¼Œä½¿è¾“å…¥ç‰¹å¾å’Œæ ‡ç­¾å€¼ä¸€ä¸€å¯¹åº”
train_db = tf.data.Dataset.from_tensor_slices((x_train, y_train)).batch(32)

# ç”Ÿæˆç¥ç»ç½‘ç»œçš„å‚æ•°ï¼Œè¾“å…¥å±‚ä¸º2ä¸ªç¥ç»å…ƒï¼Œéšè—å±‚ä¸º11ä¸ªç¥ç»å…ƒï¼Œ1å±‚éšè—å±‚ï¼Œè¾“å‡ºå±‚ä¸º1ä¸ªç¥ç»å…ƒ
# ç”¨tf.Variable()ä¿è¯å‚æ•°å¯è®­ç»ƒ
w1 = tf.Variable(tf.random.normal([2, 11]), dtype=tf.float32)  # 11æ˜¯è‡ªå·±éšä¾¿é€‰çš„ï¼›ä¸¤ä¸ªè¾“å…¥ç‰¹å¾ï¼Œæ‰€ä»¥æ˜¯2
b1 = tf.Variable(tf.constant(0.01, shape=[11]))                # b1è¦ä¸w1ä¿æŒä¸€è‡´

w2 = tf.Variable(tf.random.normal([11, 1]), dtype=tf.float32)
b2 = tf.Variable(tf.constant(0.01, shape=[1]))

lr = 0.01  # å­¦ä¹ ç‡ä¸º
epoch = 400  # å¾ªç¯è½®æ•°

# è®­ç»ƒéƒ¨åˆ†(åå‘ä¼ æ’­)
for epoch in range(epoch):
    for step, (x_train, y_train) in enumerate(train_db):  #
        with tf.GradientTape() as tape:  # è®°å½•æ¢¯åº¦ä¿¡æ¯

            h1 = tf.matmul(x_train, w1) + b1  # è®°å½•ç¥ç»ç½‘ç»œä¹˜åŠ è¿ç®—
            h1 = tf.nn.relu(h1)  # æ¿€æ´»å‡½æ•°æ˜¯relu
            y = tf.matmul(h1, w2) + b2

            # é‡‡ç”¨å‡æ–¹è¯¯å·®æŸå¤±å‡½æ•°mse = mean(sum(y-out)^2)
            loss_mse = tf.reduce_mean(tf.square(y_train - y))
            # æ·»åŠ l2æ­£åˆ™åŒ–
            loss_regularization = []
            # tf.nn.l2_loss(w)=sum(w ** 2) / 2
            loss_regularization.append(tf.nn.l2_loss(w1))
            loss_regularization.append(tf.nn.l2_loss(w2))
            # æ±‚å’Œ
            # ä¾‹ï¼šx=tf.constant(([1,1,1],[1,1,1]))
            #   tf.reduce_sum(x)
            # &gt;&gt;&gt;6
            # loss_regularization = tf.reduce_sum(tf.stack(loss_regularization))
            loss_regularization = tf.reduce_sum(loss_regularization)
            loss = loss_mse + 0.03 * loss_regularization #REGULARIZER = 0.03

        # è®¡ç®—losså¯¹å„ä¸ªå‚æ•°çš„æ¢¯åº¦
        variables = [w1, b1, w2, b2]
        grads = tape.gradient(loss, variables)

        # å®ç°æ¢¯åº¦æ›´æ–°
        # w1 = w1 - lr * w1_grad
        w1.assign_sub(lr * grads[0])
        b1.assign_sub(lr * grads[1])
        w2.assign_sub(lr * grads[2])
        b2.assign_sub(lr * grads[3])

    # æ¯200ä¸ªepochï¼Œæ‰“å°lossä¿¡æ¯
    if epoch % 20 == 0:
        print(&apos;epoch:&apos;, epoch, &apos;loss:&apos;, float(loss))

# é¢„æµ‹éƒ¨åˆ†
print(&quot;*******predict*******&quot;)
# xxåœ¨-3åˆ°3ä¹‹é—´ä»¥æ­¥é•¿ä¸º0.01ï¼Œyyåœ¨-3åˆ°3ä¹‹é—´ä»¥æ­¥é•¿0.01,ç”Ÿæˆé—´éš”æ•°å€¼ç‚¹
xx, yy = np.mgrid[-3:3:.1, -3:3:.1]
# å°†xx, yyæ‹‰ç›´ï¼Œå¹¶åˆå¹¶é…å¯¹ä¸ºäºŒç»´å¼ é‡ï¼Œç”ŸæˆäºŒç»´åæ ‡ç‚¹
grid = np.c_[xx.ravel(), yy.ravel()]
grid = tf.cast(grid, tf.float32)
# å°†ç½‘æ ¼åæ ‡ç‚¹å–‚å…¥ç¥ç»ç½‘ç»œï¼Œè¿›è¡Œé¢„æµ‹ï¼Œprobsä¸ºè¾“å‡º
probs = []
for x_predict in grid:
    # ä½¿ç”¨è®­ç»ƒå¥½çš„å‚æ•°è¿›è¡Œé¢„æµ‹
    h1 = tf.matmul([x_predict], w1) + b1
    h1 = tf.nn.relu(h1)
    y = tf.matmul(h1, w2) + b2  # yä¸ºé¢„æµ‹ç»“æœ
    probs.append(y)

# å–ç¬¬0åˆ—ç»™x1ï¼Œå–ç¬¬1åˆ—ç»™x2
x1 = x_data[:, 0]
x2 = x_data[:, 1]
# probsçš„shapeè°ƒæ•´æˆxxçš„æ ·å­
probs = np.array(probs).reshape(xx.shape)
plt.scatter(x1, x2, color=np.squeeze(Y_c))
# æŠŠåæ ‡xx yyå’Œå¯¹åº”çš„å€¼probsæ”¾å…¥contour&lt;[â€˜kÉ‘ntÊŠr]&gt;å‡½æ•°ï¼Œç»™probså€¼ä¸º0.5çš„æ‰€æœ‰ç‚¹ä¸Šè‰²  pltç‚¹showå æ˜¾ç¤ºçš„æ˜¯çº¢è“ç‚¹çš„åˆ†ç•Œçº¿
plt.contour(xx, yy, probs, levels=[.5])  # ç”»å‡ºé¢„æµ‹å€¼yä¸º0.5çš„æ›²çº¿
plt.show()

# è¯»å…¥çº¢è“ç‚¹ï¼Œç”»å‡ºåˆ†å‰²çº¿ï¼ŒåŒ…å«æ­£åˆ™åŒ–
# ä¸æ¸…æ¥šçš„æ•°æ®ï¼Œå»ºè®®printå‡ºæ¥æŸ¥çœ‹ </code></pre><p><img src="https://i.loli.net/2021/02/18/sgZV4CPf3mI5tME.png" alt="image.png"></p>
<p>è‹¥è¿‡æ‹Ÿåˆï¼Œåˆ™ç”»å‡ºçš„æ›²çº¿ä¼šä¸å¹³ç¼“<br>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåˆ™ä¸ºæœªè¿›è¡Œæ­£åˆ™åŒ–çš„æ•ˆæœ<br><img src="https://i.loli.net/2021/02/18/Sz7oqXTI4CEMsbd.png" alt="image.png">  </p>
<h1 id="å‚æ•°ä¼˜åŒ–å™¨"><a href="#å‚æ•°ä¼˜åŒ–å™¨" class="headerlink" title="å‚æ•°ä¼˜åŒ–å™¨"></a>å‚æ•°ä¼˜åŒ–å™¨</h1><p>ä¸åŒçš„ä¼˜åŒ–å™¨å®è´¨ä¸Šå°±æ˜¯å®šä¹‰äº†ä¸åŒçš„ä¸€é˜¶åŠ¨é‡å’ŒäºŒé˜¶åŠ¨é‡å…¬å¼  </p>
<p><img src="https://i.loli.net/2021/02/18/7fxpTcEh3XetyJo.png" alt="image.png">    </p>
<h2 id="SGD"><a href="#SGD" class="headerlink" title="SGD"></a>SGD</h2><p>éšæœºæ¢¯åº¦ä¸‹é™<br>ä¸€é˜¶åŠ¨é‡<code>mt</code>ä¸ºæ¢¯åº¦ï¼ŒäºŒé˜¶åŠ¨é‡<code>Vt</code>ä¸º1<br>ä¹Ÿå°±æ˜¯<code>w</code>çš„æ¯æ¬¡è·Ÿæ–°ï¼Œæ˜¯<code>lr*å¯¹åº”æ¢¯åº¦</code>   </p>
<pre><code>w1.assign_sub(lr*grads[0])
b1.assign_sub(lr*grads[1])</code></pre><h2 id="SGDM"><a href="#SGDM" class="headerlink" title="SGDM"></a>SGDM</h2><p>Î²æ˜¯è¶…å‚æ•°ï¼Œæ¥è¿‘äº1çš„æ•°å€¼ï¼Œç»éªŒå€¼æ˜¯0.9   </p>
<p><img src="https://i.loli.net/2021/02/18/qmSR5b9JaLHc1Pk.png" alt="image.png"></p>
<pre><code>m_w,m_b =0,0
beta = 0.9
m_w = beta*m_w + (1-beta) * grads[0]
m_b = beta*m_b + (1-beta) * grads[1]
w1.assign_sub(lr*m_w)
b1.assign_sub(lr*m_b)</code></pre><h2 id="Adagrad"><a href="#Adagrad" class="headerlink" title="Adagrad"></a>Adagrad</h2><p><img src="https://i.loli.net/2021/02/18/KZXiGkbIlVL3J7p.png" alt="image.png"></p>
<pre><code>v_w,v_b =0,0
v_w += tf.square(grads[0])
v_b += tf.square(grads[1])
w1.assign_sub(lr*grads[0]/tf.sqrt(v_w))
b1.assign_sub(lr*grads[1]/tf.sqrt(v_b))  </code></pre><h2 id="RMSProp"><a href="#RMSProp" class="headerlink" title="RMSProp"></a>RMSProp</h2><p><img src="https://i.loli.net/2021/02/18/YhAv1F6EaWoPiJT.png" alt="image.png">   </p>
<pre><code>v_w,v_b = 0,0
v_w = beta * v_w + (1 - beta) * tf.square(grads[0])
v_b = beta * v_b + (1 - beta) * tf.square(grads[1])
w1.assign_sub(lr * grads[0] / tf.sqrt(v_w))
b1.assign_sub(lr * grads[1] / tf.sqrt(v_b))</code></pre><h2 id="Adam"><a href="#Adam" class="headerlink" title="Adam"></a>Adam</h2><p><img src="https://i.loli.net/2021/02/18/FUBrYpCDhbLiTnH.png" alt="image.png"><br><img src="https://i.loli.net/2021/02/18/o6bUYilC7c5xXDN.png" alt="image.png"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/10/07/numpy%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/07/numpy%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">çº¿æ€§å›å½’å®æˆ˜</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-10-07 13:59:59" itemprop="dateCreated datePublished" datetime="2020-10-07T13:59:59+08:00">2020-10-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-01-15 20:34:19" itemprop="dateModified" datetime="2021-01-15T20:34:19+08:00">2021-01-15</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/17/C%E8%AF%AD%E8%A8%80%E7%BB%8F%E5%85%B8%E7%AE%97%E6%B3%95%E4%BA%94%E5%8D%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/07/17/C%E8%AF%AD%E8%A8%80%E7%BB%8F%E5%85%B8%E7%AE%97%E6%B3%95%E4%BA%94%E5%8D%81/" class="post-title-link" itemprop="url">Cè¯­è¨€ç»å…¸ç®—æ³•äº”å</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-07-17 22:51:54 / Modified: 23:10:14" itemprop="dateCreated datePublished" datetime="2020-07-17T22:51:54+08:00">2020-07-17</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="æ±‰è¯ºå¡”é—®é¢˜"><a href="#æ±‰è¯ºå¡”é—®é¢˜" class="headerlink" title="æ±‰è¯ºå¡”é—®é¢˜"></a>æ±‰è¯ºå¡”é—®é¢˜</h1><h2 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h2><p>æœ‰A,B,Cä¸‰ä¸ªæŸ±å­ï¼ŒAä¸ºåˆå§‹æŸ±å­ï¼Œä¸Šæœ‰nä¸ªä»é«˜åˆ°ä½ä»å°åˆ°å¤§å †èµ·çš„ç›˜å­ã€‚ç°è¦å°†Aä¸Šçš„ç›˜å­å…¨éƒ¨ç§»åˆ°Cä¸Šï¼Œä¿è¯ä»å§‹è‡³ç»ˆç›˜å­è¦ä¸‹å¤§ä¸Šå°ï¼Œè¯·é—®å¦‚ä½•ç§»åŠ¨ï¼Ÿ</p>
<h2 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>è¦æ‰¾åˆ°ä¸€ç›´åœ¨é‡å¤åŠ¨ä½œã€‚<br>å½“n=1æ—¶ï¼ŒA -&gt; C<br>å½“n=2æ—¶ï¼ŒA-&gt;B;A-&gt;C;B-&gt;C;<br>å½“n=3æ—¶ï¼Œä¸ºäº†è®©Cæœ€ä¸‹é¢æ˜¯æœ€å¤§çš„ï¼Œé‚£ä¹ˆAçš„æœ€åä¸€ä¸ªä¸€å®šç§»ç»™Cï¼Œæ­¤æ—¶Bæœ‰ä¸¤ä¸ªã€‚é‚£ä¹ˆBå®é™…ä¸Šå°±ç›¸å½“äºå½“n=2æ—¶çš„Cã€‚ä¹Ÿå°±æ˜¯Aä¸€å®šè¦æŠŠ2ä¸ªå…¨éƒ¨ç»™Bã€‚ä¹‹åBåˆè¦æŠŠç›˜å­å…¨éƒ¨ç»™Cã€‚</p>
<p>è¿™å…¶å®çš„æ€è·¯å®é™…ä¸Šå°±æ˜¯å°†æ‰€æœ‰çœ‹ä½œä¸€ä¸ªæ•´ä½“ï¼Œçœ‹ä½œæ˜¯ä¸Šä¸€ä¸ªæ­¥éª¤æ¥çš„ï¼Œäº¤æ¢ä½ç½®ã€‚</p>
<h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><pre><code>// æ±‰è¯ºå¡”é—®é¢˜
#include&lt;stdio.h&gt;
void hanoi(char a, char b, char c, int n);
int main(void)
{
    int n;
    char a = &apos;A&apos;, b = &apos;B&apos;, c = &apos;C&apos;;
    printf(&quot;ENTER:&quot;);
    scanf(&quot;%d&quot;, &amp;n);
    hanoi(a, b, c, n);
}
void hanoi(char a, char b, char c, int n)
{

    if (n == 1)
    {
        printf(&quot;%c -&gt; %c\n&quot;, a, c);
        return;
    }
    else
    {
        hanoi(a, c, b, n - 1);
        printf(&quot;%c -&gt; %c\n&quot;, a, c);
        hanoi(b, a, c, n - 1);
    }
}</code></pre>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">33</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> v4.1.1
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme â€“ <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.7.0
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
