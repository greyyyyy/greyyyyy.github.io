<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('http://yoursite.com').hostname,
    root: '/',
    scheme: 'Muse',
    version: '7.7.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta name="description" content="RNNï¼Œä¹Ÿå°±æ˜¯å¾ªç¯ç¥ç»ç½‘ç»œï¼Œå®ç°è¿ç»­æ•°æ®é¢„æµ‹ã€‚    å›é¡¾å·ç§¯ç¥ç»ç½‘ç»œå·ç§¯å°±æ˜¯ç‰¹å¾æå–å™¨ï¼Œå°±æ˜¯CBAPDâ€”â€”â€”â€”C(å·ç§¯),B(BNï¼Œæ‰¹æ ‡å‡†åŒ–),A(æ¿€æ´»),P(æ± åŒ–),D(èˆå¼ƒ)å·ç§¯ç¥ç»ç½‘ç»œï¼Œå°±æ˜¯å€ŸåŠ©å·ç§¯æ ¸æå–ç©ºé—´ç‰¹å¾åï¼Œé€å…¥å…¨è¿æ¥ç½‘ç»œã€‚è€Œæœ‰äº›æ•°æ®æ˜¯å’Œç©ºé—´åºåˆ—ç›¸å…³çš„ï¼Œèƒ½å¤Ÿé€šè¿‡è¿ç»­æ€§è¿›è¡Œé¢„æµ‹ã€‚    å¾ªç¯æ ¸å®šä¹‰ï¼š* å‚ä¸æ—¶é—´å…±äº«ï¼Œå¾ªç¯å±‚æå–æ—¶é—´ä¿¡æ¯å¾ªç¯æ ¸å…·æœ‰è®°å¿†åŠ›ï¼Œé€šè¿‡ä¸åŒæ—¶åˆ»çš„å‚æ•°å…±äº«ï¼Œå®ç°äº†å¯¹">
<meta property="og:type" content="article">
<meta property="og:title" content="RNNå®ç°è¿ç»­æ•°æ®é¢„æµ‹">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;02&#x2F;23&#x2F;RNN%E5%AE%9E%E7%8E%B0%E8%BF%9E%E7%BB%AD%E6%95%B0%E6%8D%AE%E9%A2%84%E6%B5%8B&#x2F;index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="RNNï¼Œä¹Ÿå°±æ˜¯å¾ªç¯ç¥ç»ç½‘ç»œï¼Œå®ç°è¿ç»­æ•°æ®é¢„æµ‹ã€‚    å›é¡¾å·ç§¯ç¥ç»ç½‘ç»œå·ç§¯å°±æ˜¯ç‰¹å¾æå–å™¨ï¼Œå°±æ˜¯CBAPDâ€”â€”â€”â€”C(å·ç§¯),B(BNï¼Œæ‰¹æ ‡å‡†åŒ–),A(æ¿€æ´»),P(æ± åŒ–),D(èˆå¼ƒ)å·ç§¯ç¥ç»ç½‘ç»œï¼Œå°±æ˜¯å€ŸåŠ©å·ç§¯æ ¸æå–ç©ºé—´ç‰¹å¾åï¼Œé€å…¥å…¨è¿æ¥ç½‘ç»œã€‚è€Œæœ‰äº›æ•°æ®æ˜¯å’Œç©ºé—´åºåˆ—ç›¸å…³çš„ï¼Œèƒ½å¤Ÿé€šè¿‡è¿ç»­æ€§è¿›è¡Œé¢„æµ‹ã€‚    å¾ªç¯æ ¸å®šä¹‰ï¼š* å‚ä¸æ—¶é—´å…±äº«ï¼Œå¾ªç¯å±‚æå–æ—¶é—´ä¿¡æ¯å¾ªç¯æ ¸å…·æœ‰è®°å¿†åŠ›ï¼Œé€šè¿‡ä¸åŒæ—¶åˆ»çš„å‚æ•°å…±äº«ï¼Œå®ç°äº†å¯¹">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;23&#x2F;GPWMR94uZwxF3fH.png">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;23&#x2F;BNpfJ8HXDwA53me.png">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;23&#x2F;MfmTOu9v2GDgU34.png">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;23&#x2F;GBPtUSpKAOcvnTo.png">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;23&#x2F;9HuhvPI86GAXeEo.png">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;23&#x2F;kEi2ZB1odtI4WUz.png">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;23&#x2F;FE1rMDqseKpLch7.png">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;23&#x2F;ma2zvbZpFnsOUf1.png">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;23&#x2F;FxyNuJk62W1P8Lr.png">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;23&#x2F;WAi2qxGPrMuLyTU.png">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;23&#x2F;lJIna3oXAgrxK5C.png">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;23&#x2F;iOfZ8b9HsWt7Gq5.png">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;23&#x2F;Ko8ETwgOPvRtHsI.png">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;23&#x2F;fOMgnlj8bxGurLI.png">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;24&#x2F;DfkZJi9K1cMEFvm.png">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;24&#x2F;AyKJpg2fh8BEHQz.png">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;24&#x2F;rvMx9lQ3dtHmhfo.png">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;24&#x2F;1BZ2DPwjtLvx5Cb.png">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;24&#x2F;SzeoTcbw3GRMO6P.png">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;24&#x2F;VZBmNuoQhYUbIF5.png">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;24&#x2F;Bv5hmYe4XfAMDPd.png">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;24&#x2F;T2SuIe3LNvCF1mf.png">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;24&#x2F;ZEYtFkfPIaJHcnB.png">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;24&#x2F;wXM2PFarYDnygVt.png">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;24&#x2F;AMeZoga72HpNWvB.png">
<meta property="og:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;24&#x2F;8v3BRiqxdUwZWEn.png">
<meta property="article:published_time" content="2021-02-23T11:26:44.000Z">
<meta property="article:modified_time" content="2021-02-25T06:13:05.951Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https:&#x2F;&#x2F;i.loli.net&#x2F;2021&#x2F;02&#x2F;23&#x2F;GPWMR94uZwxF3fH.png">

<link rel="canonical" href="http://yoursite.com/2021/02/23/RNN%E5%AE%9E%E7%8E%B0%E8%BF%9E%E7%BB%AD%E6%95%B0%E6%8D%AE%E9%A2%84%E6%B5%8B/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true
  };
</script>

  <title>RNNå®ç°è¿ç»­æ•°æ®é¢„æµ‹ | Hexo</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/02/23/RNN%E5%AE%9E%E7%8E%B0%E8%BF%9E%E7%BB%AD%E6%95%B0%E6%8D%AE%E9%A2%84%E6%B5%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          RNNå®ç°è¿ç»­æ•°æ®é¢„æµ‹
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-02-23 19:26:44" itemprop="dateCreated datePublished" datetime="2021-02-23T19:26:44+08:00">2021-02-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-02-25 14:13:05" itemprop="dateModified" datetime="2021-02-25T14:13:05+08:00">2021-02-25</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>RNNï¼Œä¹Ÿå°±æ˜¯å¾ªç¯ç¥ç»ç½‘ç»œï¼Œå®ç°è¿ç»­æ•°æ®é¢„æµ‹ã€‚   </p>
<h1 id="å›é¡¾å·ç§¯ç¥ç»ç½‘ç»œ"><a href="#å›é¡¾å·ç§¯ç¥ç»ç½‘ç»œ" class="headerlink" title="å›é¡¾å·ç§¯ç¥ç»ç½‘ç»œ"></a>å›é¡¾å·ç§¯ç¥ç»ç½‘ç»œ</h1><p>å·ç§¯å°±æ˜¯ç‰¹å¾æå–å™¨ï¼Œå°±æ˜¯<code>CBAPD</code>â€”â€”â€”â€”C(å·ç§¯),B(BNï¼Œæ‰¹æ ‡å‡†åŒ–),A(æ¿€æ´»),P(æ± åŒ–),D(èˆå¼ƒ)<br>å·ç§¯ç¥ç»ç½‘ç»œï¼Œå°±æ˜¯å€ŸåŠ©å·ç§¯æ ¸æå–ç©ºé—´ç‰¹å¾åï¼Œé€å…¥å…¨è¿æ¥ç½‘ç»œã€‚<br>è€Œæœ‰äº›æ•°æ®æ˜¯å’Œç©ºé—´åºåˆ—ç›¸å…³çš„ï¼Œèƒ½å¤Ÿé€šè¿‡è¿ç»­æ€§è¿›è¡Œé¢„æµ‹ã€‚   </p>
<h1 id="å¾ªç¯æ ¸"><a href="#å¾ªç¯æ ¸" class="headerlink" title="å¾ªç¯æ ¸"></a>å¾ªç¯æ ¸</h1><p><strong>å®šä¹‰ï¼š*</strong> å‚ä¸æ—¶é—´å…±äº«ï¼Œå¾ªç¯å±‚æå–æ—¶é—´ä¿¡æ¯<br>å¾ªç¯æ ¸å…·æœ‰è®°å¿†åŠ›ï¼Œé€šè¿‡ä¸åŒæ—¶åˆ»çš„å‚æ•°å…±äº«ï¼Œå®ç°äº†å¯¹æ—¶é—´åºåˆ—çš„ä¿¡æ¯æå–<br><img src="https://i.loli.net/2021/02/23/GPWMR94uZwxF3fH.png" alt="image.png"><br>ğŸ‘†è¿™æ˜¯è®°å¿†ä½“ï¼Œå¯ä»¥è®¾å®šè®°å¿†ä½“çš„ä¸ªæ•°ï¼Œæ”¹å˜è®°å¿†å®¹é‡ï¼Œå½“è®°å¿†ä½“ä¸ªæ•°è¢«æŒ‡å®šï¼Œè¾“å…¥Xtï¼ŒYtç»´åº¦è¢«æŒ‡å®šï¼Œå‘¨å›´çš„å¾…è®­ç»ƒå‚æ•°é‡ç»´åº¦ä¹Ÿå°±è¢«é™å®šäº†ã€‚<br>è®°å¿†ä½“å†…å­˜å‚¨ç€æ¯ä¸ªæ—¶åˆ»çš„çŠ¶æ€ä¿¡æ¯htï¼Œè®°å¿†ä½“å½“å‰æ—¶åˆ»å­˜å‚¨çš„çŠ¶æ€ä¿¡æ¯<code>ht=tanh(Xt*Wxh+h(t-1)*Whh+bh)</code>,å½“å‰æ—¶åˆ»ï¼Œå¾ªç¯æ ¸çš„è¾“å‡ºç‰¹å¾<code>yt=softmax(ht*Why+by)</code>,å®é™…ä¸Šï¼Œå¾—åˆ°è¾“å‡ºçš„ytçš„è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯ä¸€å±‚å…¨è¿æ¥ã€‚<br>ä¸‰ä¸ªå‚æ•°<code>Wxh,Whh,Why</code>,æ­£å¦‚<code>w,b</code>ä¸€æ ·ï¼Œåœ¨å‰å‘ä¼ æ’­æ—¶ï¼Œæ˜¯å›ºå®šä¸å˜çš„ï¼›åœ¨åå‘ä¼ æ’­æ—¶ï¼Œè¢«æ¢¯åº¦ä¸‹é™æ³•æ›´æ–°ã€‚   </p>
<h1 id="å¾ªç¯ç¥ç»ç½‘ç»œ"><a href="#å¾ªç¯ç¥ç»ç½‘ç»œ" class="headerlink" title="å¾ªç¯ç¥ç»ç½‘ç»œ"></a>å¾ªç¯ç¥ç»ç½‘ç»œ</h1><p>å¾ªç¯æ ¸æŒ‰æ—¶é—´æ­¥å±•å¼€ï¼Œä¹Ÿå°±æ˜¯æŠŠå¾ªç¯æ ¸æŒ‰ç…§æ—¶é—´è½´æ–¹å‘å±•å¼€ã€‚<br><img src="https://i.loli.net/2021/02/23/BNpfJ8HXDwA53me.png" alt="image.png"><br>æ¯ä¸ªæ—¶åˆ»ï¼Œè®°å¿†ä½“çŠ¶æ€ä¿¡æ¯htè¢«åˆ·æ–°ï¼Œè®°å¿†ä½“å‘¨å›´çš„å‚æ•°<code>Wxh,Whh,Why</code>æ˜¯ä¸å˜çš„ï¼Œè®­ç»ƒä¼˜åŒ–çš„å¯¹è±¡å°±æ˜¯è¿™äº›å‚æ•°çŸ©é˜µ<br>è®­ç»ƒå®Œæˆåï¼Œé€‰ç”¨æ•ˆæœæœ€å¥½çš„å‚æ•°çŸ©é˜µï¼Œæ‰§è¡Œå‰å‘ä¼ æ’­ï¼Œè¾“å‡ºé¢„æµ‹ç»“æœã€‚<br>å¾ªç¯ç¥ç»ç½‘ç»œå°±æ˜¯å€ŸåŠ©å¾ªç¯æ ¸æå–æ—¶é—´ç‰¹å¾åï¼Œé€å…¥å…¨è¿æ¥ç½‘ç»œï¼Œå®ç°è¿ç»­æ•°æ®çš„é¢„æµ‹ã€‚<br><img src="https://i.loli.net/2021/02/23/MfmTOu9v2GDgU34.png" alt="image.png"></p>
<h1 id="å¾ªç¯è®¡ç®—å±‚"><a href="#å¾ªç¯è®¡ç®—å±‚" class="headerlink" title="å¾ªç¯è®¡ç®—å±‚"></a>å¾ªç¯è®¡ç®—å±‚</h1><p>æ¯ä¸ªå¾ªç¯æ ¸æ„æˆä¸€å±‚å¾ªç¯è®¡ç®—å±‚ã€‚<br>å¾ªç¯è®¡ç®—å±‚çš„å±‚æ•°æ˜¯ç€å‘è¾“å‡ºæ–¹å‘ç”Ÿé•¿çš„ã€‚<br><img src="https://i.loli.net/2021/02/23/GBPtUSpKAOcvnTo.png" alt="image.png"><br><img src="https://i.loli.net/2021/02/23/9HuhvPI86GAXeEo.png" alt="image.png"><br><img src="https://i.loli.net/2021/02/23/kEi2ZB1odtI4WUz.png" alt="image.png"><br><img src="https://i.loli.net/2021/02/23/FE1rMDqseKpLch7.png" alt="image.png"><br>å…¥RNNæ—¶ï¼Œæ˜¯æœ‰ç»´åº¦è¦æ±‚çš„ï¼Œxçš„ç»´åº¦è¦æ˜¯ä¸‰ç»´çš„<code>(é€å…¥æ ·æœ¬æ•°,å¾ªç¯æ ¸æ—¶é—´å±•å¼€æ­¥æ•°,æ¯ä¸ªæ—¶é—´æ­¥è¾“å…¥ç‰¹å¾ä¸ªæ•°)</code><br><img src="https://i.loli.net/2021/02/23/ma2zvbZpFnsOUf1.png" alt="image.png">    </p>
<h1 id="ç¤ºä¾‹ï¼šå­—æ¯é¢„æµ‹"><a href="#ç¤ºä¾‹ï¼šå­—æ¯é¢„æµ‹" class="headerlink" title="ç¤ºä¾‹ï¼šå­—æ¯é¢„æµ‹"></a>ç¤ºä¾‹ï¼šå­—æ¯é¢„æµ‹</h1><p><strong>ç›®æ ‡ï¼š</strong>è¾“å…¥ä¸€ä¸ªå­—æ¯ï¼Œé¢„æµ‹å‡ºä¸‹ä¸€ä¸ªå­—æ¯ï¼›<br>é¦–å…ˆï¼Œç¥ç»ç½‘ç»œé¢„æµ‹çš„ç›´æ¥ç»“æœéƒ½æ˜¯æ•°å­—ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å…ˆæŠŠè¦ç”¨åˆ°çš„äº”ä¸ªå­—æ¯ç”¨æ•°å­—è¡¨ç¤ºå‡ºæ¥ï¼Œæˆ‘ä»¬ç”¨<code>one-hot</code>çš„æ–¹æ³•æ¥è¡¨ç¤ºã€‚<br><img src="https://i.loli.net/2021/02/23/FxyNuJk62W1P8Lr.png" alt="image.png"><br>éšæœºç”Ÿæˆä¸‰ä¸ªå‚æ•°çŸ©é˜µ<br><img src="https://i.loli.net/2021/02/23/WAi2qxGPrMuLyTU.png" alt="image.png"><br><img src="https://i.loli.net/2021/02/23/lJIna3oXAgrxK5C.png" alt="image.png"><br><img src="https://i.loli.net/2021/02/23/iOfZ8b9HsWt7Gq5.png" alt="image.png"><br>å½“å‰è¾“å…¥å­—æ¯bï¼Œä¹Ÿå°±æ˜¯<code>[0,1,0,0,0]</code>ï¼Œä¹˜ä¸Š<code>Wxh</code>,å†åŠ ä¸Šä¸Šä¸€ä¸ªçŠ¶æ€<code>ht*Whh</code>,å†åŠ ä¸Šåç½®é¡¹<br><img src="https://i.loli.net/2021/02/23/Ko8ETwgOPvRtHsI.png" alt="image.png"><br><img src="https://i.loli.net/2021/02/23/fOMgnlj8bxGurLI.png" alt="image.png">  </p>
<pre><code>import numpy as np
import tensorflow as tf
from tensorflow.keras.layers import Dense, SimpleRNN
import matplotlib.pyplot as plt
import os

input_word = &quot;abcde&quot;
w_to_id = {&apos;a&apos;: 0, &apos;b&apos;: 1, &apos;c&apos;: 2, &apos;d&apos;: 3, &apos;e&apos;: 4}  # å•è¯æ˜ å°„åˆ°æ•°å€¼idçš„è¯å…¸
id_to_onehot = {0: [1., 0., 0., 0., 0.], 1: [0., 1., 0., 0., 0.], 2: [0., 0., 1., 0., 0.], 3: [0., 0., 0., 1., 0.],
                4: [0., 0., 0., 0., 1.]}  # idç¼–ç ä¸ºone-hot

x_train = [id_to_onehot[w_to_id[&apos;a&apos;]], id_to_onehot[w_to_id[&apos;b&apos;]], id_to_onehot[w_to_id[&apos;c&apos;]],
        id_to_onehot[w_to_id[&apos;d&apos;]], id_to_onehot[w_to_id[&apos;e&apos;]]]
y_train = [w_to_id[&apos;b&apos;], w_to_id[&apos;c&apos;], w_to_id[&apos;d&apos;], w_to_id[&apos;e&apos;], w_to_id[&apos;a&apos;]]

np.random.seed(7)
np.random.shuffle(x_train)
np.random.seed(7)
np.random.shuffle(y_train)
tf.random.set_seed(7)

# ä½¿x_trainç¬¦åˆSimpleRNNè¾“å…¥è¦æ±‚ï¼š[é€å…¥æ ·æœ¬æ•°ï¼Œ å¾ªç¯æ ¸æ—¶é—´å±•å¼€æ­¥æ•°ï¼Œ æ¯ä¸ªæ—¶é—´æ­¥è¾“å…¥ç‰¹å¾ä¸ªæ•°]ã€‚
# æ­¤å¤„æ•´ä¸ªæ•°æ®é›†é€å…¥ï¼Œé€å…¥æ ·æœ¬æ•°ä¸ºlen(x_train)ï¼›è¾“å…¥1ä¸ªå­—æ¯å‡ºç»“æœï¼Œå¾ªç¯æ ¸æ—¶é—´å±•å¼€æ­¥æ•°ä¸º1; è¡¨ç¤ºä¸ºç‹¬çƒ­ç æœ‰5ä¸ªè¾“å…¥ç‰¹å¾ï¼Œæ¯ä¸ªæ—¶é—´æ­¥è¾“å…¥ç‰¹å¾ä¸ªæ•°ä¸º5
x_train = np.reshape(x_train, (len(x_train), 1, 5))
y_train = np.array(y_train)

model = tf.keras.Sequential([
    SimpleRNN(3),
    Dense(5, activation=&apos;softmax&apos;)
])

model.compile(optimizer=tf.keras.optimizers.Adam(0.01),
            loss=tf.keras.losses.SparseCategoricalCrossentropy(from_logits=False),
            metrics=[&apos;sparse_categorical_accuracy&apos;])

checkpoint_save_path = &quot;./checkpoint/rnn_onehot_1pre1.ckpt&quot;

if os.path.exists(checkpoint_save_path + &apos;.index&apos;):
    print(&apos;-------------load the model-----------------&apos;)
    model.load_weights(checkpoint_save_path)

cp_callback = tf.keras.callbacks.ModelCheckpoint(filepath=checkpoint_save_path,
                                                save_weights_only=True,
                                                save_best_only=True,
                                                monitor=&apos;loss&apos;)  # ç”±äºfitæ²¡æœ‰ç»™å‡ºæµ‹è¯•é›†ï¼Œä¸è®¡ç®—æµ‹è¯•é›†å‡†ç¡®ç‡ï¼Œæ ¹æ®lossï¼Œä¿å­˜æœ€ä¼˜æ¨¡å‹

history = model.fit(x_train, y_train, batch_size=32, epochs=100, callbacks=[cp_callback])

model.summary()

# print(model.trainable_variables)
file = open(&apos;./weights.txt&apos;, &apos;w&apos;)  # å‚æ•°æå–
for v in model.trainable_variables:
    file.write(str(v.name) + &apos;\n&apos;)
    file.write(str(v.shape) + &apos;\n&apos;)
    file.write(str(v.numpy()) + &apos;\n&apos;)
file.close()

###############################################    show   ###############################################

# æ˜¾ç¤ºè®­ç»ƒé›†å’ŒéªŒè¯é›†çš„accå’Œlossæ›²çº¿
acc = history.history[&apos;sparse_categorical_accuracy&apos;]
loss = history.history[&apos;loss&apos;]

plt.subplot(1, 2, 1)
plt.plot(acc, label=&apos;Training Accuracy&apos;)
plt.title(&apos;Training Accuracy&apos;)
plt.legend()

plt.subplot(1, 2, 2)
plt.plot(loss, label=&apos;Training Loss&apos;)
plt.title(&apos;Training Loss&apos;)
plt.legend()
plt.show()

############### predict #############

preNum = int(input(&quot;input the number of test alphabet:&quot;))
for i in range(preNum):
    alphabet1 = input(&quot;input test alphabet:&quot;)
    alphabet = [id_to_onehot[w_to_id[alphabet1]]]
    # ä½¿alphabetç¬¦åˆSimpleRNNè¾“å…¥è¦æ±‚ï¼š[é€å…¥æ ·æœ¬æ•°ï¼Œ å¾ªç¯æ ¸æ—¶é—´å±•å¼€æ­¥æ•°ï¼Œ æ¯ä¸ªæ—¶é—´æ­¥è¾“å…¥ç‰¹å¾ä¸ªæ•°]ã€‚æ­¤å¤„éªŒè¯æ•ˆæœé€å…¥äº†1ä¸ªæ ·æœ¬ï¼Œé€å…¥æ ·æœ¬æ•°ä¸º1ï¼›è¾“å…¥1ä¸ªå­—æ¯å‡ºç»“æœï¼Œæ‰€ä»¥å¾ªç¯æ ¸æ—¶é—´å±•å¼€æ­¥æ•°ä¸º1; è¡¨ç¤ºä¸ºç‹¬çƒ­ç æœ‰5ä¸ªè¾“å…¥ç‰¹å¾ï¼Œæ¯ä¸ªæ—¶é—´æ­¥è¾“å…¥ç‰¹å¾ä¸ªæ•°ä¸º5
    alphabet = np.reshape(alphabet, (1, 1, 5))
    result = model.predict([alphabet])
    pred = tf.argmax(result, axis=1)
    pred = int(pred)
    tf.print(alphabet1 + &apos;-&gt;&apos; + input_word[pred])</code></pre><h1 id="ç¤ºä¾‹æ·±åŒ–"><a href="#ç¤ºä¾‹æ·±åŒ–" class="headerlink" title="ç¤ºä¾‹æ·±åŒ–"></a>ç¤ºä¾‹æ·±åŒ–</h1><p><strong>ç›®çš„:</strong>è¿ç»­è¾“å…¥å››ä¸ªå­—æ¯é¢„æµ‹ä¸‹ä¸€ä¸ªå­—æ¯ã€‚<br><img src="https://i.loli.net/2021/02/24/DfkZJi9K1cMEFvm.png" alt="image.png"><br>è®²è§£å¾ªç¯æ ¸æŒ‰æ—¶é—´å±•å¼€åï¼Œå¾ªç¯è®¡ç®—è¿‡ç¨‹<br>ä½¿ç”¨ä¸‰ä¸ªè®°å¿†ä½“<br><img src="https://i.loli.net/2021/02/24/AyKJpg2fh8BEHQz.png" alt="image.png"><br>åˆå§‹æ—¶åˆ»ï¼Œè®°å¿†ä½“å†…çš„è®°å¿†æ˜¯0<br><img src="https://i.loli.net/2021/02/24/rvMx9lQ3dtHmhfo.png" alt="image.png">      </p>
<h1 id="Embeddingç¼–ç "><a href="#Embeddingç¼–ç " class="headerlink" title="Embeddingç¼–ç "></a>Embeddingç¼–ç </h1><p><strong>Embeddingï¼š</strong>æ˜¯ä¸€ç§å•è¯ç¼–ç æ–¹æ³•ï¼Œå‘ä½ç»´å‘é‡å®ç°äº†ç¼–ç ã€‚è¿™ç§ç¼–ç é€šè¿‡ç¥ç»ç½‘ç»œè®­ç»ƒä¼˜åŒ–ï¼Œèƒ½è¡¨è¾¾å‡ºå•è¯é—´çš„ç›¸å…³æ€§ã€‚   </p>
<pre><code>âœ¨tf.keras.layers.Embedding(è¯æ±‡è¡¨å¤§å°,ç¼–ç ç»´åº¦)   
# ç¼–ç ç»´åº¦å°±æ˜¯ç”¨å‡ ä¸ªæ•°å­—è¡¨è¾¾ä¸€ä¸ªå•è¯   
# å¯¹1-100çš„æ•°å­—è¿›è¡Œç¼–ç ï¼Œä¸”ç”¨ä¸‰ä¸ªæ•°å­—æ¥è¡¨è¾¾ä¸€ä¸ªæ•°   
# tf.keras.layers.Embedding(100,3)   

# å…¥Embeddingï¼Œè¦æ±‚xçš„ç»´åº¦æ˜¯äºŒç»´   
âœ¨[é€å…¥æ ·æœ¬æ•°,å¾ªç¯æ ¸æ—¶é—´å±•å¼€æ­¥æ•°]    </code></pre><hr>
<p><strong>ä¸‹é¢è¿›è¡Œåˆšåˆšçš„ä¾‹å­ç”¨<code>Embedding</code>ç¼–ç å¤ç°</strong>     </p>
<pre><code># å…¥Embeddingè¦[é€å…¥æ ·æœ¬æ•°,å¾ªç¯æ ¸æ—¶é—´å±•å¼€æ­¥æ•°]  
# å…¥RNNè¦[æ ·æœ¬æ•°,å¾ªç¯æ ¸æ—¶é—´å±•å¼€æ­¥æ•°,æ ·æœ¬ç‰¹å¾æ•°]   

# 1.import   

import numpy as np  
import tensorflow as tf
from tensorflow.keras.layers import Dense,SimpleRNN,Embedding   
import matplotlib.pyplot as plt   

word = &apos;abcde&apos;  
w_to_id = {&apos;a&apos;:0;&apos;b&apos;:1;&apos;c&apos;:2;&apos;d&apos;:3;&apos;e&apos;:4}

# 2. trainã€test 
# è¾“å…¥ä¸€ä¸ªå­—æ¯å¯¹åº”è¾“å‡ºä¸‹ä¸€ä¸ªå­—æ¯ï¼Œä¹Ÿå°±æ˜¯ä¸‹ä¸€ä¸ªå­—æ¯æ˜¯ä¸Šä¸€ä¸ªå­—æ¯çš„æ ‡ç­¾   
x_train =[w_to_id[&apos;a&apos;],w_to_id[&apos;b&apos;],w_to_id[&apos;c&apos;],w_to_id[&apos;d&apos;],w_to_id[&apos;e&apos;]]
y_train =[w_to_id[&apos;b&apos;],w_to_id[&apos;c&apos;],w_to_id[&apos;d&apos;],w_to_id[&apos;e&apos;],w_to_id[&apos;a&apos;]]  

# æ‰“ä¹±é¡ºåº    
np.random.seed(7)
np.random.shuffle(x_train)   
np.random.seed(7)   
np.random.shuffle(y_train)   
tf.random.set_seed(7)    

# å‡†å¤‡å¯¹åº”ç»´åº¦   
x_train.reshape(x_train,(len(x_train),1))   
y_train = np.array(y_train)    

# 4.sequential   
model = tf.keras.Sequential([
    Embedding(5,2) #è¿™ä¸€å±‚ä¼šç”Ÿæˆä¸€ä¸ªäº”è¡Œä¸¤åˆ—çš„å¯è®­ç»ƒå‚æ•°çŸ©é˜µ
    SimpleRNN(3)  #è®¾å®šäº†å…·æœ‰ä¸‰ä¸ªè®°å¿†ä½“çš„å¾ªç¯å±‚
    Dense(5,activation=&apos;softmax&apos;)
])   

# 5.compile   
model.compile(optimizer=tf.keras.optimizer.Adam(0.01),loss=tf.keras.losses.SparseCategoricalCrossentroy(from_logits=False),metrics=[&apos;sparse_categorical_accuracy&apos;])   

checkpoint_save_path = &quot;./checkpoint/run_embedding_1pre1.ckpt&quot;

if os.path.exists(checkpoint_save_path + &apos;.index&apos;):
    print(&apos;-------------load the model-----------------&apos;)
    model.load_weights(checkpoint_save_path)

cp_callback = tf.keras.callbacks.ModelCheckpoint(filepath=checkpoint_save_path,
                                                save_weights_only=True,
                                                save_best_only=True,
                                                monitor=&apos;loss&apos;)  # ç”±äºfitæ²¡æœ‰ç»™å‡ºæµ‹è¯•é›†ï¼Œä¸è®¡ç®—æµ‹è¯•é›†å‡†ç¡®ç‡ï¼Œæ ¹æ®lossï¼Œä¿å­˜æœ€ä¼˜æ¨¡å‹

history = model.fit(x_train, y_train, batch_size=32, epochs=100, callbacks=[cp_callback])

model.summary()

# print(model.trainable_variables)
file = open(&apos;./weights.txt&apos;, &apos;w&apos;)  # å‚æ•°æå–
for v in model.trainable_variables:
    file.write(str(v.name) + &apos;\n&apos;)
    file.write(str(v.shape) + &apos;\n&apos;)
    file.write(str(v.numpy()) + &apos;\n&apos;)
file.close()

###############################################    show   ###############################################

# æ˜¾ç¤ºè®­ç»ƒé›†å’ŒéªŒè¯é›†çš„accå’Œlossæ›²çº¿
acc = history.history[&apos;sparse_categorical_accuracy&apos;]
loss = history.history[&apos;loss&apos;]

plt.subplot(1, 2, 1)
plt.plot(acc, label=&apos;Training Accuracy&apos;)
plt.title(&apos;Training Accuracy&apos;)
plt.legend()

plt.subplot(1, 2, 2)
plt.plot(loss, label=&apos;Training Loss&apos;)
plt.title(&apos;Training Loss&apos;)
plt.legend()
plt.show()

############### predict #############

preNum = int(input(&quot;input the number of test alphabet:&quot;))
for i in range(preNum):
    alphabet1 = input(&quot;input test alphabet:&quot;)
    alphabet = [w_to_id[alphabet1]]
    # ä½¿alphabetç¬¦åˆEmbeddingè¾“å…¥è¦æ±‚ï¼š[é€å…¥æ ·æœ¬æ•°ï¼Œ å¾ªç¯æ ¸æ—¶é—´å±•å¼€æ­¥æ•°]ã€‚
    # æ­¤å¤„éªŒè¯æ•ˆæœé€å…¥äº†1ä¸ªæ ·æœ¬ï¼Œé€å…¥æ ·æœ¬æ•°ä¸º1ï¼›è¾“å…¥1ä¸ªå­—æ¯å‡ºç»“æœï¼Œå¾ªç¯æ ¸æ—¶é—´å±•å¼€æ­¥æ•°ä¸º1ã€‚
    alphabet = np.reshape(alphabet, (1, 1))
    result = model.predict(alphabet)
    pred = tf.argmax(result, axis=1)
    pred = int(pred)
    tf.print(alphabet1 + &apos;-&gt;&apos; + input_word[pred])</code></pre><hr>
<p><strong>ä¸‹é¢æ·±åŒ–å¤ç°</strong><br><img src="https://i.loli.net/2021/02/24/1BZ2DPwjtLvx5Cb.png" alt="image.png">   </p>
<pre><code>import numpy as np
import tensorflow as tf
from tensorflow.keras.layers import Dense, SimpleRNN, Embedding
import matplotlib.pyplot as plt
import os

input_word = &quot;abcdefghijklmnopqrstuvwxyz&quot;
w_to_id = {&apos;a&apos;: 0, &apos;b&apos;: 1, &apos;c&apos;: 2, &apos;d&apos;: 3, &apos;e&apos;: 4,
        &apos;f&apos;: 5, &apos;g&apos;: 6, &apos;h&apos;: 7, &apos;i&apos;: 8, &apos;j&apos;: 9,
        &apos;k&apos;: 10, &apos;l&apos;: 11, &apos;m&apos;: 12, &apos;n&apos;: 13, &apos;o&apos;: 14,
        &apos;p&apos;: 15, &apos;q&apos;: 16, &apos;r&apos;: 17, &apos;s&apos;: 18, &apos;t&apos;: 19,
        &apos;u&apos;: 20, &apos;v&apos;: 21, &apos;w&apos;: 22, &apos;x&apos;: 23, &apos;y&apos;: 24, &apos;z&apos;: 25}  # å•è¯æ˜ å°„åˆ°æ•°å€¼idçš„è¯å…¸

training_set_scaled = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
                    11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                    21, 22, 23, 24, 25]

x_train = []
y_train = []

for i in range(4, 26):
    x_train.append(training_set_scaled[i - 4:i])
    y_train.append(training_set_scaled[i])

np.random.seed(7)
np.random.shuffle(x_train)
np.random.seed(7)
np.random.shuffle(y_train)
tf.random.set_seed(7)

# ä½¿x_trainç¬¦åˆEmbeddingè¾“å…¥è¦æ±‚ï¼š[é€å…¥æ ·æœ¬æ•°ï¼Œ å¾ªç¯æ ¸æ—¶é—´å±•å¼€æ­¥æ•°] ï¼Œ
# æ­¤å¤„æ•´ä¸ªæ•°æ®é›†é€å…¥æ‰€ä»¥é€å…¥ï¼Œé€å…¥æ ·æœ¬æ•°ä¸ºlen(x_train)ï¼›è¾“å…¥4ä¸ªå­—æ¯å‡ºç»“æœï¼Œå¾ªç¯æ ¸æ—¶é—´å±•å¼€æ­¥æ•°ä¸º4ã€‚
x_train = np.reshape(x_train, (len(x_train), 4))
y_train = np.array(y_train)

model = tf.keras.Sequential([
    Embedding(26, 2),
    SimpleRNN(10),
    Dense(26, activation=&apos;softmax&apos;)
])

model.compile(optimizer=tf.keras.optimizers.Adam(0.01),
            loss=tf.keras.losses.SparseCategoricalCrossentropy(from_logits=False),
            metrics=[&apos;sparse_categorical_accuracy&apos;])

checkpoint_save_path = &quot;./checkpoint/rnn_embedding_4pre1.ckpt&quot;

if os.path.exists(checkpoint_save_path + &apos;.index&apos;):
    print(&apos;-------------load the model-----------------&apos;)
    model.load_weights(checkpoint_save_path)

cp_callback = tf.keras.callbacks.ModelCheckpoint(filepath=checkpoint_save_path,
                                                save_weights_only=True,
                                                save_best_only=True,
                                                monitor=&apos;loss&apos;)  # ç”±äºfitæ²¡æœ‰ç»™å‡ºæµ‹è¯•é›†ï¼Œä¸è®¡ç®—æµ‹è¯•é›†å‡†ç¡®ç‡ï¼Œæ ¹æ®lossï¼Œä¿å­˜æœ€ä¼˜æ¨¡å‹

history = model.fit(x_train, y_train, batch_size=32, epochs=100, callbacks=[cp_callback])

model.summary()

file = open(&apos;./weights.txt&apos;, &apos;w&apos;)  # å‚æ•°æå–
for v in model.trainable_variables:
    file.write(str(v.name) + &apos;\n&apos;)
    file.write(str(v.shape) + &apos;\n&apos;)
    file.write(str(v.numpy()) + &apos;\n&apos;)
file.close()

###############################################    show   ###############################################

# æ˜¾ç¤ºè®­ç»ƒé›†å’ŒéªŒè¯é›†çš„accå’Œlossæ›²çº¿
acc = history.history[&apos;sparse_categorical_accuracy&apos;]
loss = history.history[&apos;loss&apos;]

plt.subplot(1, 2, 1)
plt.plot(acc, label=&apos;Training Accuracy&apos;)
plt.title(&apos;Training Accuracy&apos;)
plt.legend()

plt.subplot(1, 2, 2)
plt.plot(loss, label=&apos;Training Loss&apos;)
plt.title(&apos;Training Loss&apos;)
plt.legend()
plt.show()

################# predict ##################

preNum = int(input(&quot;input the number of test alphabet:&quot;))
for i in range(preNum):
    alphabet1 = input(&quot;input test alphabet:&quot;)
    alphabet = [w_to_id[a] for a in alphabet1]
    # ä½¿alphabetç¬¦åˆEmbeddingè¾“å…¥è¦æ±‚ï¼š[é€å…¥æ ·æœ¬æ•°ï¼Œ æ—¶é—´å±•å¼€æ­¥æ•°]ã€‚
    # æ­¤å¤„éªŒè¯æ•ˆæœé€å…¥äº†1ä¸ªæ ·æœ¬ï¼Œé€å…¥æ ·æœ¬æ•°ä¸º1ï¼›è¾“å…¥4ä¸ªå­—æ¯å‡ºç»“æœï¼Œå¾ªç¯æ ¸æ—¶é—´å±•å¼€æ­¥æ•°ä¸º4ã€‚
    alphabet = np.reshape(alphabet, (1, 4))
    result = model.predict([alphabet])
    pred = tf.argmax(result, axis=1)
    pred = int(pred)
    tf.print(alphabet1 + &apos;-&gt;&apos; + input_word[pred])</code></pre><h1 id="RNNå®ç°è‚¡ç¥¨é¢„æµ‹"><a href="#RNNå®ç°è‚¡ç¥¨é¢„æµ‹" class="headerlink" title="RNNå®ç°è‚¡ç¥¨é¢„æµ‹"></a>RNNå®ç°è‚¡ç¥¨é¢„æµ‹</h1><h2 id="æ•°æ®æº"><a href="#æ•°æ®æº" class="headerlink" title="æ•°æ®æº"></a>æ•°æ®æº</h2><p><img src="https://i.loli.net/2021/02/24/SzeoTcbw3GRMO6P.png" alt="image.png"><br>è¿™ä¸ªæ–‡ä»¶æ˜¯ç”¨tushareæ¨¡å—ä¸‹è½½çš„SH600519è´µå·èŒ…å°æ—¥kçº¿æ•°æ®<br>åœ¨è¯¥ä¾‹ä¸­ï¼Œåªç”¨Cåˆ—çš„ï¼Œä¹Ÿå°±æ˜¯å¼€ç›˜ä»·çš„ï¼Œè¿ç»­60å¤©çš„æ•°æ®ï¼Œé¢„æµ‹ç¬¬61å¤©çš„å¼€ç›˜ä»·    </p>
<pre><code>import numpy as np
import tensorflow as tf
from tensorflow.keras.layers import Dropout, Dense, SimpleRNN
import matplotlib.pyplot as plt
import os
import pandas as pd
from sklearn.preprocessing import MinMaxScaler
from sklearn.metrics import mean_squared_error, mean_absolute_error
import math

maotai = pd.read_csv(&apos;./SH600519.csv&apos;)  # è¯»å–è‚¡ç¥¨æ–‡ä»¶

training_set = maotai.iloc[0:2426 - 300, 2:3].values  # å‰(2426-300=2126)å¤©çš„å¼€ç›˜ä»·ä½œä¸ºè®­ç»ƒé›†,è¡¨æ ¼ä»0å¼€å§‹è®¡æ•°ï¼Œ2:3 æ˜¯æå–[2:3)åˆ—ï¼Œå‰é—­åå¼€,æ•…æå–å‡ºCåˆ—å¼€ç›˜ä»·
test_set = maotai.iloc[2426 - 300:, 2:3].values  # å300å¤©çš„å¼€ç›˜ä»·ä½œä¸ºæµ‹è¯•é›†

# å½’ä¸€åŒ–
sc = MinMaxScaler(feature_range=(0, 1))  # å®šä¹‰å½’ä¸€åŒ–ï¼šå½’ä¸€åŒ–åˆ°(0ï¼Œ1)ä¹‹é—´
training_set_scaled = sc.fit_transform(training_set)  # æ±‚å¾—è®­ç»ƒé›†çš„æœ€å¤§å€¼ï¼Œæœ€å°å€¼è¿™äº›è®­ç»ƒé›†å›ºæœ‰çš„å±æ€§ï¼Œå¹¶åœ¨è®­ç»ƒé›†ä¸Šè¿›è¡Œå½’ä¸€åŒ–
test_set = sc.transform(test_set)  # åˆ©ç”¨è®­ç»ƒé›†çš„å±æ€§å¯¹æµ‹è¯•é›†è¿›è¡Œå½’ä¸€åŒ–

x_train = []
y_train = []

x_test = []
y_test = []

# æµ‹è¯•é›†ï¼šcsvè¡¨æ ¼ä¸­å‰2426-300=2126å¤©æ•°æ®
# åˆ©ç”¨forå¾ªç¯ï¼Œéå†æ•´ä¸ªè®­ç»ƒé›†ï¼Œæå–è®­ç»ƒé›†ä¸­è¿ç»­60å¤©çš„å¼€ç›˜ä»·ä½œä¸ºè¾“å…¥ç‰¹å¾x_trainï¼Œç¬¬61å¤©çš„æ•°æ®ä½œä¸ºæ ‡ç­¾ï¼Œforå¾ªç¯å…±æ„å»º2426-300-60=2066ç»„æ•°æ®ã€‚
for i in range(60, len(training_set_scaled)):
    x_train.append(training_set_scaled[i - 60:i, 0])
    y_train.append(training_set_scaled[i, 0])
# å¯¹è®­ç»ƒé›†è¿›è¡Œæ‰“ä¹±
np.random.seed(7)
np.random.shuffle(x_train)
np.random.seed(7)
np.random.shuffle(y_train)
tf.random.set_seed(7)
# å°†è®­ç»ƒé›†ç”±listæ ¼å¼å˜ä¸ºarrayæ ¼å¼
x_train, y_train = np.array(x_train), np.array(y_train)

# ä½¿x_trainç¬¦åˆRNNè¾“å…¥è¦æ±‚ï¼š[é€å…¥æ ·æœ¬æ•°ï¼Œ å¾ªç¯æ ¸æ—¶é—´å±•å¼€æ­¥æ•°ï¼Œ æ¯ä¸ªæ—¶é—´æ­¥è¾“å…¥ç‰¹å¾ä¸ªæ•°]ã€‚
# æ­¤å¤„æ•´ä¸ªæ•°æ®é›†é€å…¥ï¼Œé€å…¥æ ·æœ¬æ•°ä¸ºx_train.shape[0]å³2066ç»„æ•°æ®ï¼›è¾“å…¥60ä¸ªå¼€ç›˜ä»·ï¼Œé¢„æµ‹å‡ºç¬¬61å¤©çš„å¼€ç›˜ä»·ï¼Œå¾ªç¯æ ¸æ—¶é—´å±•å¼€æ­¥æ•°ä¸º60; æ¯ä¸ªæ—¶é—´æ­¥é€å…¥çš„ç‰¹å¾æ˜¯æŸä¸€å¤©çš„å¼€ç›˜ä»·ï¼Œåªæœ‰1ä¸ªæ•°æ®ï¼Œæ•…æ¯ä¸ªæ—¶é—´æ­¥è¾“å…¥ç‰¹å¾ä¸ªæ•°ä¸º1
x_train = np.reshape(x_train, (x_train.shape[0], 60, 1))
# æµ‹è¯•é›†ï¼šcsvè¡¨æ ¼ä¸­å300å¤©æ•°æ®
# åˆ©ç”¨forå¾ªç¯ï¼Œéå†æ•´ä¸ªæµ‹è¯•é›†ï¼Œæå–æµ‹è¯•é›†ä¸­è¿ç»­60å¤©çš„å¼€ç›˜ä»·ä½œä¸ºè¾“å…¥ç‰¹å¾x_trainï¼Œç¬¬61å¤©çš„æ•°æ®ä½œä¸ºæ ‡ç­¾ï¼Œforå¾ªç¯å…±æ„å»º300-60=240ç»„æ•°æ®ã€‚
for i in range(60, len(test_set)):
    x_test.append(test_set[i - 60:i, 0])
    y_test.append(test_set[i, 0])
# æµ‹è¯•é›†å˜arrayå¹¶reshapeä¸ºç¬¦åˆRNNè¾“å…¥è¦æ±‚ï¼š[é€å…¥æ ·æœ¬æ•°ï¼Œ å¾ªç¯æ ¸æ—¶é—´å±•å¼€æ­¥æ•°ï¼Œ æ¯ä¸ªæ—¶é—´æ­¥è¾“å…¥ç‰¹å¾ä¸ªæ•°]
x_test, y_test = np.array(x_test), np.array(y_test)
x_test = np.reshape(x_test, (x_test.shape[0], 60, 1))

model = tf.keras.Sequential([
    SimpleRNN(80, return_sequences=True),
    Dropout(0.2),
    SimpleRNN(100),
    Dropout(0.2),
    Dense(1)
])

model.compile(optimizer=tf.keras.optimizers.Adam(0.001),
            loss=&apos;mean_squared_error&apos;)  # æŸå¤±å‡½æ•°ç”¨å‡æ–¹è¯¯å·®
# è¯¥åº”ç”¨åªè§‚æµ‹lossæ•°å€¼ï¼Œä¸è§‚æµ‹å‡†ç¡®ç‡ï¼Œæ‰€ä»¥åˆ å»metricsé€‰é¡¹ï¼Œä¸€ä¼šåœ¨æ¯ä¸ªepochè¿­ä»£æ˜¾ç¤ºæ—¶åªæ˜¾ç¤ºlosså€¼

checkpoint_save_path = &quot;./checkpoint/rnn_stock.ckpt&quot;

if os.path.exists(checkpoint_save_path + &apos;.index&apos;):
    print(&apos;-------------load the model-----------------&apos;)
    model.load_weights(checkpoint_save_path)

cp_callback = tf.keras.callbacks.ModelCheckpoint(filepath=checkpoint_save_path,
                                                save_weights_only=True,
                                                save_best_only=True,
                                                monitor=&apos;val_loss&apos;)

history = model.fit(x_train, y_train, batch_size=64, epochs=50, validation_data=(x_test, y_test), validation_freq=1,
                    callbacks=[cp_callback])

model.summary()

file = open(&apos;./weights.txt&apos;, &apos;w&apos;)  # å‚æ•°æå–
for v in model.trainable_variables:
    file.write(str(v.name) + &apos;\n&apos;)
    file.write(str(v.shape) + &apos;\n&apos;)
    file.write(str(v.numpy()) + &apos;\n&apos;)
file.close()

loss = history.history[&apos;loss&apos;]
val_loss = history.history[&apos;val_loss&apos;]

plt.plot(loss, label=&apos;Training Loss&apos;)
plt.plot(val_loss, label=&apos;Validation Loss&apos;)
plt.title(&apos;Training and Validation Loss&apos;)
plt.legend()
plt.show()

################## predict ######################
# æµ‹è¯•é›†è¾“å…¥æ¨¡å‹è¿›è¡Œé¢„æµ‹
predicted_stock_price = model.predict(x_test)
# å¯¹é¢„æµ‹æ•°æ®è¿˜åŸ---ä»ï¼ˆ0ï¼Œ1ï¼‰åå½’ä¸€åŒ–åˆ°åŸå§‹èŒƒå›´
predicted_stock_price = sc.inverse_transform(predicted_stock_price)
# å¯¹çœŸå®æ•°æ®è¿˜åŸ---ä»ï¼ˆ0ï¼Œ1ï¼‰åå½’ä¸€åŒ–åˆ°åŸå§‹èŒƒå›´
real_stock_price = sc.inverse_transform(test_set[60:])
# ç”»å‡ºçœŸå®æ•°æ®å’Œé¢„æµ‹æ•°æ®çš„å¯¹æ¯”æ›²çº¿
plt.plot(real_stock_price, color=&apos;red&apos;, label=&apos;MaoTai Stock Price&apos;)
plt.plot(predicted_stock_price, color=&apos;blue&apos;, label=&apos;Predicted MaoTai Stock Price&apos;)
plt.title(&apos;MaoTai Stock Price Prediction&apos;)
plt.xlabel(&apos;Time&apos;)
plt.ylabel(&apos;MaoTai Stock Price&apos;)
plt.legend()
plt.show()

##########evaluate##############
# calculate MSE å‡æ–¹è¯¯å·® ---&gt; E[(é¢„æµ‹å€¼-çœŸå®å€¼)^2] (é¢„æµ‹å€¼å‡çœŸå®å€¼æ±‚å¹³æ–¹åæ±‚å‡å€¼)
mse = mean_squared_error(predicted_stock_price, real_stock_price)
# calculate RMSE å‡æ–¹æ ¹è¯¯å·®---&gt;sqrt[MSE]    (å¯¹å‡æ–¹è¯¯å·®å¼€æ–¹)
rmse = math.sqrt(mean_squared_error(predicted_stock_price, real_stock_price))
# calculate MAE å¹³å‡ç»å¯¹è¯¯å·®-----&gt;E[|é¢„æµ‹å€¼-çœŸå®å€¼|](é¢„æµ‹å€¼å‡çœŸå®å€¼æ±‚ç»å¯¹å€¼åæ±‚å‡å€¼ï¼‰
mae = mean_absolute_error(predicted_stock_price, real_stock_price)
print(&apos;å‡æ–¹è¯¯å·®: %.6f&apos; % mse)
print(&apos;å‡æ–¹æ ¹è¯¯å·®: %.6f&apos; % rmse)
print(&apos;å¹³å‡ç»å¯¹è¯¯å·®: %.6f&apos; % mae)</code></pre><p><img src="https://i.loli.net/2021/02/24/VZBmNuoQhYUbIF5.png" alt="image.png"><br><img src="https://i.loli.net/2021/02/24/Bv5hmYe4XfAMDPd.png" alt="image.png"><br><img src="https://i.loli.net/2021/02/24/T2SuIe3LNvCF1mf.png" alt="image.png"></p>
<h1 id="ç”¨LSTMå®ç°è‚¡ç¥¨é¢„æµ‹"><a href="#ç”¨LSTMå®ç°è‚¡ç¥¨é¢„æµ‹" class="headerlink" title="ç”¨LSTMå®ç°è‚¡ç¥¨é¢„æµ‹"></a>ç”¨LSTMå®ç°è‚¡ç¥¨é¢„æµ‹</h1><h2 id="LSTMä»‹ç»"><a href="#LSTMä»‹ç»" class="headerlink" title="LSTMä»‹ç»"></a>LSTMä»‹ç»</h2><p>ä¼ ç»Ÿå¾ªç¯ç½‘ç»œRNNå¯ä»¥é€šè¿‡è®°å¿†ä½“å®ç°çŸ­æœŸè®°å¿†ï¼Œè¿›è¡Œè¿ç»­æ•°æ®çš„é¢„æµ‹ï¼Œä½†å½“è¿ç»­æ•°æ®çš„åºåˆ—å˜é•¿æ—¶ï¼Œä¼šä½¿å±•å¼€æ—¶é—´æ­¥è¿‡é•¿ï¼Œåœ¨åå‘ä¼ æ’­æ›´æ–°å‚æ•°æ—¶ï¼Œæ¢¯åº¦è¦æŒ‰ç…§æ—¶é—´æ­¥è¿ç»­ç›¸ä¹˜ï¼Œä¼šå¯¼è‡´æ¢¯åº¦æ¶ˆå¤±ã€‚<br>æ‰€ä»¥æå‡ºäº†é•¿çŸ­è®°å¿†ç½‘ç»œLSTM<br>LSTMä¸­å¼•å…¥äº†ä¸‰ä¸ªé—¨é™<br><img src="https://i.loli.net/2021/02/24/ZEYtFkfPIaJHcnB.png" alt="image.png"><br>ä¸‰ä¸ªé—¨é™ï¼Œéƒ½æ˜¯å½“å‰æ—¶åˆ»è¾“å…¥ç‰¹å¾xtå’Œä¸Šä¸ªæ—¶åˆ»çš„çŸ­æœŸè®°å¿†h(t-1)çš„å‡½æ•°ã€‚<code>Wiï¼ŒWfï¼ŒWo</code>éƒ½æ˜¯å¾…è®­ç»ƒå‚æ•°çŸ©é˜µ,<code>bi,bf,bo</code>éƒ½æ˜¯å¾…è®­ç»ƒåç½®é¡¹ï¼Œæœ€åç»è¿‡<code>sigmoid</code>æ¿€æ´»å‡½æ•°ï¼Œä½¿é—¨é™çš„èŒƒå›´åœ¨0-1ä¹‹é—´<br>ç»†èƒæ€æ˜¯<code>ä¸Šä¸ªæ—¶åˆ»çš„é•¿æœŸè®°å¿†*é—å¿˜é—¨+å½“å‰æ—¶åˆ»å½’çº³å‡ºçš„æ–°çŸ¥è¯†*è¾“å…¥é—¨</code><br>è®°å¿†ä½“ï¼ŒçŸ­æœŸè®°å¿†ï¼Œæ˜¯é•¿æœŸè®°å¿†çš„ä¸€éƒ¨åˆ†ã€‚æ˜¯ç»†èƒæ€è¿‡æ¿€æ´»å‡½æ•°<code>tanh</code>ï¼Œä¹˜ä¸Šè¾“å‡ºé—¨çš„ç»“æœ<br>å€™é€‰æ€è¡¨ç¤ºå½’çº³å‡ºçš„å¾…å­˜å…¥ç»†èƒæ€çš„æ–°çŸ¥è¯†<br><img src="https://i.loli.net/2021/02/24/wXM2PFarYDnygVt.png" alt="image.png">   </p>
<p>LSTMå°±æ˜¯æˆ‘ä»¬å¬è¯¾çš„è¿‡ç¨‹ã€‚å¦‚æœæˆ‘ä»¬å¬è¯¾æ˜¯ç”±pptæˆè¯¾ã€‚é‚£ä¹ˆæˆ‘ä»¬è„‘è¢‹é‡Œç°åœ¨è®°ä½çš„å†…å®¹å°±æ˜¯æˆ‘ä»¬çš„é•¿æœŸè®°å¿†ï¼Œæ˜¯å½“å‰é¡µpptåˆ°ç¬¬ä¸€å¼ pptæ•´ä¸ªé•¿æœŸè®°å¿†ã€‚<br>é•¿æœŸè®°å¿†ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œä¸€éƒ¨åˆ†æ˜¯èµ·å§‹é¡µåˆ°å‰ä¸€é¡µçš„çŸ¥è¯†ä¹˜ä¸Šé—å¿˜é—¨ï¼Œä¹Ÿå°±æ˜¯å‰é¢çš„å†…å®¹åœ¨å½“å‰å‰©ä½™çš„éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯è¿‡å»çš„è®°å¿†ã€‚å¦ä¸€éƒ¨åˆ†æ˜¯å½“å‰é¡µçš„æ–°çŸ¥è¯†ï¼Œæ˜¯å³å°†å­˜å…¥è„‘ä¸­çš„ç°åœ¨çš„è®°å¿†ã€‚<br>ç°åœ¨çš„è®°å¿†ï¼šç”±å½“å‰æ—¶åˆ»çš„è¾“å…¥<code>xt</code>å’Œä¸Šä¸€é¡µçš„çŸ­æœŸè®°å¿†ç•™å­˜<code>ht</code>å½’çº³å½¢æˆçš„æ–°çŸ¥è¯†ä¹˜ä¸Šè¾“å…¥é—¨ã€‚<br>ç°åœ¨çš„è®°å¿†å’Œè¿‡å»çš„è®°å¿†ä¸€åŒå­˜å‚¨ä¸ºé•¿æœŸè®°å¿†ã€‚<br>å½“è¿›è¡Œå¤è¿°æ—¶ï¼Œä¸å¯èƒ½ä¸€å­—ä¸è½çš„è®²å‡ºæ¥ï¼Œæˆ‘ä»¬è®²çš„æ˜¯ç•™å­˜åœ¨è„‘ä¸­çš„é•¿æœŸè®°å¿†ç»è¿‡è¾“å‡ºé—¨ç­›é€‰åçš„å†…å®¹ã€‚è¿™å°±æ˜¯è®°å¿†ä½“çš„è¾“å‡ºht<br>å½“æœ‰å¤šå±‚å¾ªç¯ç½‘ç»œæ—¶ï¼Œç¬¬äºŒå±‚çš„å¾ªç¯ç½‘ç»œçš„è¾“å…¥xtå°±æ˜¯ç¬¬ä¸€å±‚å¾ªç¯ç½‘ç»œçš„è¾“å‡ºhtã€‚è¾“å…¥ç¬¬äºŒå±‚ç½‘ç»œçš„æ˜¯ç¬¬ä¸€å±‚ç½‘ç»œæå–å‡ºæ¥çš„ç²¾åã€‚   </p>
<h2 id="LSTMçš„Tensorflowå®ç°"><a href="#LSTMçš„Tensorflowå®ç°" class="headerlink" title="LSTMçš„Tensorflowå®ç°"></a>LSTMçš„Tensorflowå®ç°</h2><p><strong>tf.keras.layers.LSTM(è®°å¿†ä½“ä¸ªæ•°,return_sequences=æ˜¯å¦è¿”å›è¾“å‡º)</strong>   </p>
<ul>
<li>return_sequences æ˜¯å¦æ¯ä¸ªæ—¶é—´æ­¥éƒ½è¾“å‡ºht   <ul>
<li>True æ¯ä¸ªæ—¶é—´è¾“å‡ºht  </li>
<li>False ä»…åœ¨æœ€åæ—¶é—´æ­¥è¾“å‡ºht(é»˜è®¤)   </li>
</ul>
</li>
</ul>
<p><strong>ğŸ±ä¸¾ä¾‹</strong>   </p>
<pre><code>model = tf.keras.Sequential([
    LSTM(80,return_sequences=True),
    Dropout(0.2)
    LSTM(100)
    Dropout(0.2)
    Dense(1)
])   </code></pre><h2 id="LSTMå®ç°è‚¡ç¥¨é¢„æµ‹"><a href="#LSTMå®ç°è‚¡ç¥¨é¢„æµ‹" class="headerlink" title="LSTMå®ç°è‚¡ç¥¨é¢„æµ‹"></a>LSTMå®ç°è‚¡ç¥¨é¢„æµ‹</h2><p>åªéœ€æ”¹åŠ¨   </p>
<ul>
<li>importéƒ¨åˆ†ï¼Œä¸å†import SimpleRNN    </li>
<li>modeléƒ¨åˆ†æ”¹æˆä¸Šé¢çš„æ ·å­å³å¯    </li>
</ul>
<h1 id="GRUå®ç°è‚¡ç¥¨é¢„æµ‹"><a href="#GRUå®ç°è‚¡ç¥¨é¢„æµ‹" class="headerlink" title="GRUå®ç°è‚¡ç¥¨é¢„æµ‹"></a>GRUå®ç°è‚¡ç¥¨é¢„æµ‹</h1><h2 id="GRUä»‹ç»"><a href="#GRUä»‹ç»" class="headerlink" title="GRUä»‹ç»"></a>GRUä»‹ç»</h2><p>GRUä½¿è®°å¿†ä½“htèåˆäº†é•¿æœŸè®°å¿†å’ŒçŸ­æœŸè®°å¿†ã€‚<br><img src="https://i.loli.net/2021/02/24/AMeZoga72HpNWvB.png" alt="image.png"></p>
<p>æ›´æ–°é—¨å’Œé‡ç½®é—¨éƒ½æ˜¯0-1.<br>å‰å‘ä¼ æ’­æ—¶ï¼Œæ˜¯è®¡ç®—çš„è®°å¿†ä½“è®¡ç®—å…¬å¼ï¼Œè®¡ç®—å‡ºæ¯ä¸ªæ—¶åˆ»çš„htå€¼</p>
<h2 id="TFæè¿°GRUå±‚"><a href="#TFæè¿°GRUå±‚" class="headerlink" title="TFæè¿°GRUå±‚"></a>TFæè¿°GRUå±‚</h2><p><strong>tf.keras.layers.GRU(è®°å¿†ä½“ä¸ªæ•°,return_sequences=æ˜¯å¦è¿”å›è¾“å‡º)</strong>   </p>
<ul>
<li>return_sequences é»˜è®¤False<br>  ä¸€èˆ¬æœ€åä¸€å±‚æ˜¯Falseï¼Œä¸­é—´å±‚æ˜¯True</li>
</ul>
<p><img src="https://i.loli.net/2021/02/24/8v3BRiqxdUwZWEn.png" alt="image.png">   </p>
<h2 id="GRUå®ç°è‚¡ç¥¨é¢„æµ‹-1"><a href="#GRUå®ç°è‚¡ç¥¨é¢„æµ‹-1" class="headerlink" title="GRUå®ç°è‚¡ç¥¨é¢„æµ‹"></a>GRUå®ç°è‚¡ç¥¨é¢„æµ‹</h2><p>åŒLSTM,åªéœ€æ›´æ”¹   </p>
<ul>
<li>import æ”¹ä¸º  GRU  </li>
<li>model å¤„æ”¹ä¸ºä¸Šå›¾ä»£ç   </li>
</ul>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/02/22/%E7%BB%8F%E5%85%B8%E5%8D%B7%E7%A7%AF%E7%BD%91%E7%BB%9C/" rel="prev" title="ç»å…¸å·ç§¯ç½‘ç»œ">
      <i class="fa fa-chevron-left"></i> ç»å…¸å·ç§¯ç½‘ç»œ
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#å›é¡¾å·ç§¯ç¥ç»ç½‘ç»œ"><span class="nav-number">1.</span> <span class="nav-text">å›é¡¾å·ç§¯ç¥ç»ç½‘ç»œ</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#å¾ªç¯æ ¸"><span class="nav-number">2.</span> <span class="nav-text">å¾ªç¯æ ¸</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#å¾ªç¯ç¥ç»ç½‘ç»œ"><span class="nav-number">3.</span> <span class="nav-text">å¾ªç¯ç¥ç»ç½‘ç»œ</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#å¾ªç¯è®¡ç®—å±‚"><span class="nav-number">4.</span> <span class="nav-text">å¾ªç¯è®¡ç®—å±‚</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ç¤ºä¾‹ï¼šå­—æ¯é¢„æµ‹"><span class="nav-number">5.</span> <span class="nav-text">ç¤ºä¾‹ï¼šå­—æ¯é¢„æµ‹</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ç¤ºä¾‹æ·±åŒ–"><span class="nav-number">6.</span> <span class="nav-text">ç¤ºä¾‹æ·±åŒ–</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Embeddingç¼–ç "><span class="nav-number">7.</span> <span class="nav-text">Embeddingç¼–ç </span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#RNNå®ç°è‚¡ç¥¨é¢„æµ‹"><span class="nav-number">8.</span> <span class="nav-text">RNNå®ç°è‚¡ç¥¨é¢„æµ‹</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#æ•°æ®æº"><span class="nav-number">8.1.</span> <span class="nav-text">æ•°æ®æº</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ç”¨LSTMå®ç°è‚¡ç¥¨é¢„æµ‹"><span class="nav-number">9.</span> <span class="nav-text">ç”¨LSTMå®ç°è‚¡ç¥¨é¢„æµ‹</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#LSTMä»‹ç»"><span class="nav-number">9.1.</span> <span class="nav-text">LSTMä»‹ç»</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LSTMçš„Tensorflowå®ç°"><span class="nav-number">9.2.</span> <span class="nav-text">LSTMçš„Tensorflowå®ç°</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LSTMå®ç°è‚¡ç¥¨é¢„æµ‹"><span class="nav-number">9.3.</span> <span class="nav-text">LSTMå®ç°è‚¡ç¥¨é¢„æµ‹</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#GRUå®ç°è‚¡ç¥¨é¢„æµ‹"><span class="nav-number">10.</span> <span class="nav-text">GRUå®ç°è‚¡ç¥¨é¢„æµ‹</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#GRUä»‹ç»"><span class="nav-number">10.1.</span> <span class="nav-text">GRUä»‹ç»</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TFæè¿°GRUå±‚"><span class="nav-number">10.2.</span> <span class="nav-text">TFæè¿°GRUå±‚</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GRUå®ç°è‚¡ç¥¨é¢„æµ‹-1"><span class="nav-number">10.3.</span> <span class="nav-text">GRUå®ç°è‚¡ç¥¨é¢„æµ‹</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">40</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> v4.1.1
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme â€“ <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.7.0
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
